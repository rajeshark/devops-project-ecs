{"ast":null,"code":"import _objectSpread from\"D:/raju new 1/front-end/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useState,useContext,useEffect}from'react';import{cartService}from'../services/cartService';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();export const useCart=()=>{return useContext(CartContext);};export const CartProvider=_ref=>{let{children}=_ref;const[cartItems,setCartItems]=useState([]);const[loading,setLoading]=useState(false);const{user}=useAuth();useEffect(()=>{if(user){fetchCart();}else{const savedCart=localStorage.getItem('guestCart');if(savedCart){setCartItems(JSON.parse(savedCart));}}},[user]);const fetchCart=async()=>{try{const items=await cartService.getCart();setCartItems(items||[]);}catch(error){console.error('Error fetching cart:',error);}};const addToCart=async function(product){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(user){try{await cartService.addToCart(product.id,quantity);await fetchCart();}catch(error){console.error('Error adding to cart:',error);}}else{const existingItem=cartItems.find(item=>item.id===product.id);let updatedCart;if(existingItem){updatedCart=cartItems.map(item=>item.id===product.id?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+quantity}):item);}else{updatedCart=[...cartItems,_objectSpread(_objectSpread({},product),{},{quantity})];}setCartItems(updatedCart);localStorage.setItem('guestCart',JSON.stringify(updatedCart));}};const removeFromCart=async productId=>{if(user){try{await cartService.removeFromCart(productId);await fetchCart();}catch(error){console.error('Error removing from cart:',error);}}else{const updatedCart=cartItems.filter(item=>item.id!==productId);setCartItems(updatedCart);localStorage.setItem('guestCart',JSON.stringify(updatedCart));}};const updateQuantity=async(productId,quantity)=>{if(user){try{await cartService.updateQuantity(productId,quantity);await fetchCart();}catch(error){console.error('Error updating quantity:',error);}}else{const updatedCart=cartItems.map(item=>item.id===productId?_objectSpread(_objectSpread({},item),{},{quantity}):item);setCartItems(updatedCart);localStorage.setItem('guestCart',JSON.stringify(updatedCart));}};const clearCart=()=>{setCartItems([]);localStorage.removeItem('guestCart');};const getCartTotal=()=>{return cartItems.reduce((total,item)=>total+item.price*item.quantity,0);};const getCartItemsCount=()=>{return cartItems.reduce((total,item)=>total+item.quantity,0);};const value={cartItems,addToCart,removeFromCart,updateQuantity,clearCart,getCartTotal,getCartItemsCount,loading};return/*#__PURE__*/_jsx(CartContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","cartService","useAuth","jsx","_jsx","CartContext","useCart","CartProvider","_ref","children","cartItems","setCartItems","loading","setLoading","user","fetchCart","savedCart","localStorage","getItem","JSON","parse","items","getCart","error","console","addToCart","product","quantity","arguments","length","undefined","id","existingItem","find","item","updatedCart","map","_objectSpread","setItem","stringify","removeFromCart","productId","filter","updateQuantity","clearCart","removeItem","getCartTotal","reduce","total","price","getCartItemsCount","value","Provider"],"sources":["D:/raju new 1/front-end/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { cartService } from '../services/cartService';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => {\r\n  return useContext(CartContext);\r\n};\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchCart();\r\n    } else {\r\n      const savedCart = localStorage.getItem('guestCart');\r\n      if (savedCart) {\r\n        setCartItems(JSON.parse(savedCart));\r\n      }\r\n    }\r\n  }, [user]);\r\n\r\n  const fetchCart = async () => {\r\n    try {\r\n      const items = await cartService.getCart();\r\n      setCartItems(items || []);\r\n    } catch (error) {\r\n      console.error('Error fetching cart:', error);\r\n    }\r\n  };\r\n\r\n  const addToCart = async (product, quantity = 1) => {\r\n    if (user) {\r\n      try {\r\n        await cartService.addToCart(product.id, quantity);\r\n        await fetchCart();\r\n      } catch (error) {\r\n        console.error('Error adding to cart:', error);\r\n      }\r\n    } else {\r\n      const existingItem = cartItems.find(item => item.id === product.id);\r\n      let updatedCart;\r\n      \r\n      if (existingItem) {\r\n        updatedCart = cartItems.map(item =>\r\n          item.id === product.id \r\n            ? { ...item, quantity: item.quantity + quantity }\r\n            : item\r\n        );\r\n      } else {\r\n        updatedCart = [...cartItems, { ...product, quantity }];\r\n      }\r\n      \r\n      setCartItems(updatedCart);\r\n      localStorage.setItem('guestCart', JSON.stringify(updatedCart));\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    if (user) {\r\n      try {\r\n        await cartService.removeFromCart(productId);\r\n        await fetchCart();\r\n      } catch (error) {\r\n        console.error('Error removing from cart:', error);\r\n      }\r\n    } else {\r\n      const updatedCart = cartItems.filter(item => item.id !== productId);\r\n      setCartItems(updatedCart);\r\n      localStorage.setItem('guestCart', JSON.stringify(updatedCart));\r\n    }\r\n  };\r\n\r\n  const updateQuantity = async (productId, quantity) => {\r\n    if (user) {\r\n      try {\r\n        await cartService.updateQuantity(productId, quantity);\r\n        await fetchCart();\r\n      } catch (error) {\r\n        console.error('Error updating quantity:', error);\r\n      }\r\n    } else {\r\n      const updatedCart = cartItems.map(item =>\r\n        item.id === productId ? { ...item, quantity } : item\r\n      );\r\n      setCartItems(updatedCart);\r\n      localStorage.setItem('guestCart', JSON.stringify(updatedCart));\r\n    }\r\n  };\r\n\r\n  const clearCart = () => {\r\n    setCartItems([]);\r\n    localStorage.removeItem('guestCart');\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n  };\r\n\r\n  const getCartItemsCount = () => {\r\n    return cartItems.reduce((total, item) => total + item.quantity, 0);\r\n  };\r\n\r\n  const value = {\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    updateQuantity,\r\n    clearCart,\r\n    getCartTotal,\r\n    getCartItemsCount,\r\n    loading\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}