{"ast":null,"code":"import _objectSpread from\"D:/raju new 1/front-end/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _taggedTemplateLiteral from\"D:/raju new 1/front-end/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23;import React,{useState,useEffect}from'react';import styled from'styled-components';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  background: #f8f9fa;\\n  min-height: 100vh;\\n\"])));const Header=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  background: white;\\n  padding: 20px;\\n  border-radius: 10px;\\n  margin-bottom: 20px;\\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n\"])));const Button=styled.button(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  padding: 12px 24px;\\n  background: #667eea;\\n  color: white;\\n  border: none;\\n  border-radius: 6px;\\n  cursor: pointer;\\n  font-weight: 600;\\n  \\n  &:hover {\\n    background: #764ba2;\\n  }\\n\"])));const OrdersTable=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  background: white;\\n  border-radius: 10px;\\n  overflow: hidden;\\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\n\"])));const TableHeader=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;\\n  padding: 15px 20px;\\n  background: #f8f9fa;\\n  font-weight: 600;\\n  border-bottom: 1px solid #e9ecef;\\n\"])));const TableRow=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;\\n  padding: 15px 20px;\\n  border-bottom: 1px solid #e9ecef;\\n  align-items: center;\\n  \\n  &:hover {\\n    background: #f8f9fa;\\n  }\\n  \\n  &:last-child {\\n    border-bottom: none;\\n  }\\n\"])));const StatusBadge=styled.span(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  padding: 4px 12px;\\n  border-radius: 20px;\\n  font-size: 12px;\\n  font-weight: 600;\\n  \\n  &.pending { background: #fff3cd; color: #856404; }\\n  &.confirmed { background: #d1ecf1; color: #0c5460; }\\n  &.shipped { background: #d4edda; color: #155724; }\\n  &.delivered { background: #e2e3e5; color: #383d41; }\\n  &.cancelled { background: #f8d7da; color: #721c24; }\\n\"])));const Loading=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: 50px;\\n  font-size: 18px;\\n  color: #666;\\n\"])));const EmptyState=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: 50px;\\n  color: #666;\\n\"])));const ActionButton=styled.button(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  padding: 6px 12px;\\n  border: none;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  font-size: 12px;\\n  margin: 2px;\\n  \\n  &.primary { background: #007bff; color: white; }\\n  &.success { background: #28a745; color: white; }\\n  &.warning { background: #ffc107; color: black; }\\n  &.danger { background: #dc3545; color: white; }\\n\"])));const Modal=styled.div(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  background: rgba(0, 0, 0, 0.5);\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  z-index: 1000;\\n\"])));const ModalContent=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  background: white;\\n  padding: 30px;\\n  border-radius: 10px;\\n  width: 90%;\\n  max-width: 400px;\\n  text-align: center;\\n\"])));const ModalActions=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 10px;\\n  justify-content: center;\\n  margin-top: 20px;\\n\"])));const ConfirmButton=styled.button(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  padding: 10px 20px;\\n  background: #dc3545;\\n  color: white;\\n  border: none;\\n  border-radius: 5px;\\n  cursor: pointer;\\n  font-weight: 600;\\n\"])));const CancelButton=styled.button(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  padding: 10px 20px;\\n  background: #6c757d;\\n  color: white;\\n  border: none;\\n  border-radius: 5px;\\n  cursor: pointer;\\n  font-weight: 600;\\n\"])));const SuccessMessage=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  background: #d4edda;\\n  color: #155724;\\n  padding: 12px;\\n  border-radius: 6px;\\n  margin-bottom: 20px;\\n  border: 1px solid #c3e6cb;\\n\"])));const ErrorMessage=styled.div(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  background: #f8d7da;\\n  color: #721c24;\\n  padding: 12px;\\n  border-radius: 6px;\\n  margin-bottom: 20px;\\n  border: 1px solid #f5c6cb;\\n\"])));const ShippingModal=styled(Modal)(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\"])));const ShippingModalContent=styled(ModalContent)(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  max-width: 500px;\\n  text-align: left;\\n\"])));const FormGroup=styled.div(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  margin-bottom: 15px;\\n\"])));const Label=styled.label(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  display: block;\\n  margin-bottom: 5px;\\n  font-weight: 600;\\n  color: #333;\\n\"])));const Input=styled.input(_templateObject20||(_templateObject20=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 8px 12px;\\n  border: 1px solid #ddd;\\n  border-radius: 4px;\\n  font-size: 14px;\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: #667eea;\\n  }\\n\"])));const Select=styled.select(_templateObject21||(_templateObject21=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 8px 12px;\\n  border: 1px solid #ddd;\\n  border-radius: 4px;\\n  font-size: 14px;\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: #667eea;\\n  }\\n\"])));const CustomerInfo=styled.div(_templateObject22||(_templateObject22=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: 10px;\\n\"])));const CustomerAvatar=styled.div(_templateObject23||(_templateObject23=_taggedTemplateLiteral([\"\\n  width: 32px;\\n  height: 32px;\\n  border-radius: 50%;\\n  background: #667eea;\\n  color: white;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-weight: 600;\\n  font-size: 14px;\\n\"])));const AdminOrders=()=>{var _deleteModal$id,_shippingModal$id;const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[deleteModal,setDeleteModal]=useState(null);const[shippingModal,setShippingModal]=useState(null);const[message,setMessage]=useState('');const[error,setError]=useState('');const[shippingData,setShippingData]=useState({trackingNumber:'',carrier:'QuickCart Logistics',estimatedDelivery:''});const navigate=useNavigate();const getAuthHeader=()=>{const token=localStorage.getItem('adminToken');return token?{Authorization:\"Bearer \".concat(token)}:{};};// UPDATED: Function to get user data from database using profile system\nconst getUserDataFromDatabase=async userId=>{try{var _response$data$users;console.log('🔍 Fetching user data for userId:',userId);// Get all users from auth service\nconst response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/users\"),{headers:getAuthHeader()});console.log('✅ Users data response:',response.data);// Find the user with matching ID - UPDATED for profile system\nconst user=Array.isArray(response.data)?response.data.find(u=>u.id===userId||u._id===userId):(_response$data$users=response.data.users)===null||_response$data$users===void 0?void 0:_response$data$users.find(u=>u.id===userId||u._id===userId);if(user){var _user$profile,_user$profile2,_user$profile3;console.log('✅ User found with profile system:',user);// UPDATED: Extract data from profile system\nconst userData={email:user.email,username:user.username,name:((_user$profile=user.profile)===null||_user$profile===void 0?void 0:_user$profile.name)||'',phone:((_user$profile2=user.profile)===null||_user$profile2===void 0?void 0:_user$profile2.phone)||'',// Addresses are now in profile.addresses\naddresses:((_user$profile3=user.profile)===null||_user$profile3===void 0?void 0:_user$profile3.addresses)||[]};console.log('📧 User data extracted:',userData);return userData;}else{console.error('❌ User not found with ID:',userId);return null;}}catch(error){var _error$response;console.error('❌ Failed to fetch users:',error);console.error('Error details:',(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data);return null;}};const fetchOrders=async()=>{try{setLoading(true);const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/admin/all\"),{headers:getAuthHeader(),params:{includeUser:true,includeCustomer:true}});const ordersData=response.data.orders||response.data||[];console.log('📦 Orders loaded:',ordersData.length);// UPDATED: Enhanced user data logging for profile system\nif(ordersData.length>0){console.log('🔍 Checking user data in orders (profile system):');ordersData.forEach(order=>{var _order$user,_order$user2,_order$user2$profile,_order$user3;console.log(\"Order \".concat(order.id,\":\"),{userId:order.userId,hasUserData:!!order.user,userEmail:(_order$user=order.user)===null||_order$user===void 0?void 0:_order$user.email,userName:(_order$user2=order.user)===null||_order$user2===void 0?void 0:(_order$user2$profile=_order$user2.profile)===null||_order$user2$profile===void 0?void 0:_order$user2$profile.name,userProfile:(_order$user3=order.user)===null||_order$user3===void 0?void 0:_order$user3.profile});});}setOrders(ordersData);}catch(error){console.error('Error fetching orders:',error);setError('Failed to load orders');setOrders([]);}finally{setLoading(false);}};useEffect(()=>{fetchOrders();},[]);// UPDATED: Helper to get customer display info\nconst getCustomerDisplayInfo=order=>{var _order$user4,_order$user4$profile,_order$user5;// Try to get from user profile first\nif((_order$user4=order.user)!==null&&_order$user4!==void 0&&(_order$user4$profile=_order$user4.profile)!==null&&_order$user4$profile!==void 0&&_order$user4$profile.name){return{name:order.user.profile.name,email:order.user.email,initial:order.user.profile.name.charAt(0).toUpperCase()};}// Fallback to email-based info\nconst email=order.userEmail||order.email||((_order$user5=order.user)===null||_order$user5===void 0?void 0:_order$user5.email)||'Customer';const nameFromEmail=email.split('@')[0];return{name:nameFromEmail,email:email,initial:nameFromEmail.charAt(0).toUpperCase()};};// UPDATED: Function to send email with profile system data\nconst sendEmailWithData=async(order,status,userEmail,userData)=>{try{var _userData$addresses,_userData$addresses2;console.log('📤 Preparing to send email to:',userEmail);// UPDATED: Prepare order data with profile system info\nconst orderDataForEmail={id:order.id,products:order.products||order.items||[],// UPDATED: Use profile addresses if available\naddress:(userData===null||userData===void 0?void 0:(_userData$addresses=userData.addresses)===null||_userData$addresses===void 0?void 0:_userData$addresses[0])||order.address||order.shippingAddress||{},shippingAddress:order.shippingAddress||order.address||(userData===null||userData===void 0?void 0:(_userData$addresses2=userData.addresses)===null||_userData$addresses2===void 0?void 0:_userData$addresses2[0])||{},totalAmount:order.amount||order.totalAmount||0,shipping:order.shipping||0,tax:order.tax||0,trackingNumber:shippingData.trackingNumber,carrier:shippingData.carrier,estimatedDelivery:shippingData.estimatedDelivery,status:status,createdAt:order.createdAt||new Date().toISOString(),// UPDATED: Include profile data\ncustomerName:(userData===null||userData===void 0?void 0:userData.name)||'',customerEmail:userEmail,userEmail:userEmail,email:userEmail};console.log('📦 Final email data prepared with profile system:',{orderId:orderDataForEmail.id,userEmail:userEmail,customerName:userData===null||userData===void 0?void 0:userData.name,status:status,trackingNumber:shippingData.trackingNumber});const emailData={orderData:orderDataForEmail,userEmail:userEmail,status:status};console.log('🚀 Sending to endpoint:',\"\".concat(process.env.REACT_APP_API_URL,\"/api/email/shipping-update\"));const response=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/email/shipping-update\"),emailData,{headers:getAuthHeader(),timeout:15000});console.log('✅ Shipping email sent successfully:',response.data);return true;}catch(error){var _error$response2,_error$response3;console.error('❌ Email sending failed:',error);console.error('Error details:',{message:error.message,response:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data,status:(_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status});return false;}};// UPDATED: Function to send shipping email with profile system\nconst sendShippingEmail=async(order,status)=>{try{var _order$user6,_order$user7,_order$user8,_userData;console.log('📧 Sending shipping email for order:',order.id,'Status:',status);let userEmail=order.userEmail||order.email||order.customerEmail||((_order$user6=order.user)===null||_order$user6===void 0?void 0:_order$user6.email);let userData=null;console.log('📧 Email search results:',{userEmail:userEmail,user:order.user});// UPDATED: If no email found or we need profile data, fetch from database\nif((!userEmail||!((_order$user7=order.user)!==null&&_order$user7!==void 0&&_order$user7.profile))&&order.userId){console.log('🔍 Fetching user data from database for profile info...');userData=await getUserDataFromDatabase(order.userId);if(userData){userEmail=userData.email||userEmail;}}else if((_order$user8=order.user)!==null&&_order$user8!==void 0&&_order$user8.profile){// Use existing user profile data\nuserData={name:order.user.profile.name,email:order.user.email,addresses:order.user.profile.addresses};}if(!userEmail){console.error('❌ No email found for order after database lookup.');return false;}console.log('✅ Using user data:',{userEmail,userName:(_userData=userData)===null||_userData===void 0?void 0:_userData.name});return await sendEmailWithData(order,status,userEmail,userData);}catch(emailError){console.error('❌ Failed to send shipping email:',emailError);return false;}};// UPDATED: Similar updates for cancellation email...\nconst sendCancellationWithData=async(order,userEmail,userData)=>{try{var _userData$addresses3;const emailData={orderData:{id:order.id,products:order.products||order.items||[],// UPDATED: Use profile addresses\naddress:(userData===null||userData===void 0?void 0:(_userData$addresses3=userData.addresses)===null||_userData$addresses3===void 0?void 0:_userData$addresses3[0])||order.address||order.shippingAddress||{},totalAmount:order.amount||order.totalAmount||0,shipping:order.shipping||0,tax:order.tax||0,createdAt:order.createdAt||new Date().toISOString(),customerName:(userData===null||userData===void 0?void 0:userData.name)||'',customerEmail:userEmail,userEmail:userEmail},userEmail:userEmail};console.log('📤 Sending cancellation email with profile data...');const response=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/email/order-cancellation\"),emailData,{headers:getAuthHeader(),timeout:15000});console.log('✅ Cancellation email sent successfully:',response.data);return true;}catch(error){console.error('❌ Cancellation email sending failed:',error);return false;}};const sendCancellationEmail=async order=>{try{var _order$user9,_order$user0,_order$user1,_userData2;console.log('📧 Sending cancellation email for order:',order.id);let userEmail=order.userEmail||order.email||order.customerEmail||((_order$user9=order.user)===null||_order$user9===void 0?void 0:_order$user9.email);let userData=null;// UPDATED: Fetch profile data if needed\nif((!userEmail||!((_order$user0=order.user)!==null&&_order$user0!==void 0&&_order$user0.profile))&&order.userId){userData=await getUserDataFromDatabase(order.userId);if(userData){userEmail=userData.email||userEmail;}}else if((_order$user1=order.user)!==null&&_order$user1!==void 0&&_order$user1.profile){userData={name:order.user.profile.name,email:order.user.email,addresses:order.user.profile.addresses};}if(!userEmail){console.error('❌ No email found for order cancellation.');return false;}console.log('✅ Using user data for cancellation:',{userEmail,userName:(_userData2=userData)===null||_userData2===void 0?void 0:_userData2.name});return await sendCancellationWithData(order,userEmail,userData);}catch(emailError){console.error('❌ Failed to send cancellation email:',emailError);return false;}};const updateOrderStatus=async(orderId,newStatus,order)=>{try{console.log(\"\\uD83D\\uDD04 Updating order \".concat(orderId,\" to status: \").concat(newStatus));const updateResponse=await axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(orderId,\"/status\"),{status:newStatus},{headers:getAuthHeader()});console.log('✅ Order status updated in database:',updateResponse.data);let emailSent=false;let emailType='';if(newStatus==='shipped'){emailSent=await sendShippingEmail(order,'shipped');emailType='shipping confirmation';}else if(newStatus==='delivered'){emailSent=await sendShippingEmail(order,'delivered');emailType='delivery confirmation';}else if(newStatus==='cancelled'){emailSent=await sendCancellationEmail(order);emailType='cancellation';}setMessage(\"Order status updated to \".concat(newStatus).concat(emailSent?\" and \".concat(emailType,\" email sent\"):' (email failed - no user email found)'));fetchOrders();setShippingModal(null);}catch(error){var _error$response4,_error$response4$data;console.error('Error updating order:',error);setError(\"Failed to update order status: \".concat(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||error.message));}};const deleteOrder=async orderId=>{try{await axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(orderId),{headers:getAuthHeader()});setMessage('Order deleted successfully');setDeleteModal(null);fetchOrders();}catch(error){console.error('Error deleting order:',error);setError('Failed to delete order');setDeleteModal(null);}};const openDeleteModal=order=>{setDeleteModal(order);};const closeDeleteModal=()=>{setDeleteModal(null);};const openShippingModal=order=>{setShippingModal(order);const trackingNumber=\"TRK\".concat(Math.random().toString(36).substr(2,9).toUpperCase());const estimatedDelivery=new Date(Date.now()+5*24*60*60*1000).toISOString().split('T')[0];setShippingData({trackingNumber:trackingNumber,carrier:'QuickCart Logistics',estimatedDelivery:estimatedDelivery});};const closeShippingModal=()=>{setShippingModal(null);setShippingData({trackingNumber:'',carrier:'QuickCart Logistics',estimatedDelivery:''});};const handleShippingDataChange=(field,value)=>{setShippingData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));};const handleShipOrder=()=>{if(shippingModal){updateOrderStatus(shippingModal.id,'shipped',_objectSpread(_objectSpread({},shippingModal),{},{trackingNumber:shippingData.trackingNumber,carrier:shippingData.carrier}));}};const cancelOrder=async(orderId,order)=>{try{await axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(orderId,\"/status\"),{status:'cancelled'},{headers:getAuthHeader()});const emailSent=await sendCancellationEmail(order);setMessage(\"Order cancelled\".concat(emailSent?' and cancellation email sent':' (email failed - no user email found)'));fetchOrders();}catch(error){console.error('Error cancelling order:',error);setError('Failed to cancel order');}};const clearMessages=()=>{setMessage('');setError('');};// UPDATED: Test email endpoint with profile system\nconst testEmailEndpoint=async()=>{try{var _userData$addresses4;console.log('🧪 Testing email endpoint with profile system...');const testOrder=orders.find(order=>order.userId);if(!testOrder){setError('No orders with user data found to test email');return false;}console.log('🔍 Testing with order:',testOrder.id,'userId:',testOrder.userId);const userData=await getUserDataFromDatabase(testOrder.userId);if(!userData||!userData.email){setError('No user email found for testing');return false;}const testData={orderData:{id:testOrder.id,products:testOrder.products||[],address:((_userData$addresses4=userData.addresses)===null||_userData$addresses4===void 0?void 0:_userData$addresses4[0])||testOrder.address||{},totalAmount:testOrder.amount||testOrder.totalAmount||0,shipping:testOrder.shipping||0,tax:testOrder.tax||0,trackingNumber:'TRKTEST123',carrier:'QuickCart Logistics',status:'shipped',customerName:userData.name,customerEmail:userData.email,createdAt:testOrder.createdAt||new Date().toISOString()},userEmail:userData.email,status:'shipped'};const response=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/email/shipping-update\"),testData,{headers:getAuthHeader(),timeout:15000});console.log('✅ Test email endpoint response:',response.data);setMessage(\"Test email sent successfully to \".concat(userData.email,\"!\"));return true;}catch(error){var _error$response5,_error$response5$data;console.error('❌ Test email endpoint failed:',error);setError(\"Test email failed: \".concat(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||error.message));return false;}};if(loading){return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Header,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCCB Manage Orders\"})}),/*#__PURE__*/_jsx(Loading,{children:\"Loading orders from database...\"})]});}return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCCB Manage Orders\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>navigate('/admin/dashboard'),children:\"\\u2190 Back to Dashboard\"})]}),message&&/*#__PURE__*/_jsxs(SuccessMessage,{children:[\"\\u2705 \",message,/*#__PURE__*/_jsx(\"button\",{onClick:clearMessages,style:{marginLeft:'10px',background:'none',border:'none',color:'#155724',cursor:'pointer'},children:\"\\xD7\"})]}),error&&/*#__PURE__*/_jsxs(ErrorMessage,{children:[\"\\u274C \",error,/*#__PURE__*/_jsx(\"button\",{onClick:clearMessages,style:{marginLeft:'10px',background:'none',border:'none',color:'#721c24',cursor:'pointer'},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(Button,{onClick:fetchOrders,style:{marginRight:'10px'},children:\"\\uD83D\\uDD04 Refresh Orders\"}),/*#__PURE__*/_jsx(Button,{onClick:testEmailEndpoint,style:{background:'#ffc107',color:'black'},children:\"\\uD83E\\uDDEA Test Email Endpoint\"})]}),orders.length===0?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"No orders found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Orders will appear here when customers make purchases\"})]}):/*#__PURE__*/_jsxs(OrdersTable,{children:[/*#__PURE__*/_jsxs(TableHeader,{children:[/*#__PURE__*/_jsx(\"div\",{children:\"Order ID\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Payment\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Actions\"})]}),orders.map(order=>{var _order$id;const customerInfo=getCustomerDisplayInfo(order);return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"#\",((_order$id=order.id)===null||_order$id===void 0?void 0:_order$id.slice(-8))||'N/A']}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(CustomerInfo,{children:[/*#__PURE__*/_jsx(CustomerAvatar,{children:customerInfo.initial}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'600',fontSize:'14px'},children:customerInfo.name}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#666'},children:customerInfo.email})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",order.amount||order.totalAmount||'0.00']}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(StatusBadge,{className:order.status,children:order.status})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(StatusBadge,{className:order.paymentStatus,children:order.paymentStatus})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ActionButton,{className:\"primary\",onClick:()=>navigate(\"/orders\"),children:\"View\"}),order.status==='confirmed'&&/*#__PURE__*/_jsx(ActionButton,{className:\"success\",onClick:()=>openShippingModal(order),children:\"Ship\"}),order.status==='shipped'&&/*#__PURE__*/_jsx(ActionButton,{className:\"warning\",onClick:()=>updateOrderStatus(order.id,'delivered',order),children:\"Deliver\"}),order.status!=='cancelled'&&order.status!=='delivered'&&/*#__PURE__*/_jsx(ActionButton,{className:\"danger\",onClick:()=>cancelOrder(order.id,order),children:\"Cancel\"}),/*#__PURE__*/_jsx(ActionButton,{className:\"danger\",onClick:()=>openDeleteModal(order),children:\"Delete\"})]})]},order.id);})]}),deleteModal&&/*#__PURE__*/_jsx(Modal,{children:/*#__PURE__*/_jsxs(ModalContent,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Confirm Order Deletion\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete this order?\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order ID:\"}),\" #\",((_deleteModal$id=deleteModal.id)===null||_deleteModal$id===void 0?void 0:_deleteModal$id.slice(-8))||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Amount:\"}),\" $\",deleteModal.amount||deleteModal.totalAmount]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",deleteModal.status]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#dc3545',fontWeight:'600'},children:\"\\u26A0\\uFE0F This action cannot be undone!\"}),/*#__PURE__*/_jsxs(ModalActions,{children:[/*#__PURE__*/_jsx(ConfirmButton,{onClick:()=>deleteOrder(deleteModal.id),children:\"Delete Order\"}),/*#__PURE__*/_jsx(CancelButton,{onClick:closeDeleteModal,children:\"Cancel\"})]})]})}),shippingModal&&/*#__PURE__*/_jsx(ShippingModal,{children:/*#__PURE__*/_jsxs(ShippingModalContent,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDE9A Ship Order\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Shipping order #\",((_shippingModal$id=shippingModal.id)===null||_shippingModal$id===void 0?void 0:_shippingModal$id.slice(-8))||'N/A']}),(()=>{const customerInfo=getCustomerDisplayInfo(shippingModal);return/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Customer:\"}),\" \",customerInfo.name,\" (\",customerInfo.email,\")\"]});})(),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:\"Tracking Number *\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",value:shippingData.trackingNumber,onChange:e=>handleShippingDataChange('trackingNumber',e.target.value),placeholder:\"Enter tracking number\",required:true})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:\"Carrier *\"}),/*#__PURE__*/_jsxs(Select,{value:shippingData.carrier,onChange:e=>handleShippingDataChange('carrier',e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"QuickCart Logistics\",children:\"QuickCart Logistics\"}),/*#__PURE__*/_jsx(\"option\",{value:\"FedEx\",children:\"FedEx\"}),/*#__PURE__*/_jsx(\"option\",{value:\"UPS\",children:\"UPS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"USPS\",children:\"USPS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"DHL\",children:\"DHL\"})]})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:\"Estimated Delivery *\"}),/*#__PURE__*/_jsx(Input,{type:\"date\",value:shippingData.estimatedDelivery,onChange:e=>handleShippingDataChange('estimatedDelivery',e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#e7f3ff',padding:'15px',borderRadius:'8px',marginBottom:'20px',borderLeft:'4px solid #007bff'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 10px 0',color:'#004085'},children:\"\\uD83D\\uDCE7 Email Notification\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'5px 0',fontSize:'14px',color:'#004085'},children:\"A shipping confirmation email will be sent to the customer's registered email address\"})]}),/*#__PURE__*/_jsxs(ModalActions,{children:[/*#__PURE__*/_jsx(ConfirmButton,{onClick:handleShipOrder,style:{background:'#28a745'},disabled:!shippingData.trackingNumber||!shippingData.carrier||!shippingData.estimatedDelivery,children:\"Confirm Shipping & Send Email\"}),/*#__PURE__*/_jsx(CancelButton,{onClick:closeShippingModal,children:\"Cancel\"})]})]})})]});};export default AdminOrders;","map":{"version":3,"names":["React","useState","useEffect","styled","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Container","div","_templateObject","_taggedTemplateLiteral","Header","_templateObject2","Button","button","_templateObject3","OrdersTable","_templateObject4","TableHeader","_templateObject5","TableRow","_templateObject6","StatusBadge","span","_templateObject7","Loading","_templateObject8","EmptyState","_templateObject9","ActionButton","_templateObject0","Modal","_templateObject1","ModalContent","_templateObject10","ModalActions","_templateObject11","ConfirmButton","_templateObject12","CancelButton","_templateObject13","SuccessMessage","_templateObject14","ErrorMessage","_templateObject15","ShippingModal","_templateObject16","ShippingModalContent","_templateObject17","FormGroup","_templateObject18","Label","label","_templateObject19","Input","input","_templateObject20","Select","select","_templateObject21","CustomerInfo","_templateObject22","CustomerAvatar","_templateObject23","AdminOrders","_deleteModal$id","_shippingModal$id","orders","setOrders","loading","setLoading","deleteModal","setDeleteModal","shippingModal","setShippingModal","message","setMessage","error","setError","shippingData","setShippingData","trackingNumber","carrier","estimatedDelivery","navigate","getAuthHeader","token","localStorage","getItem","Authorization","concat","getUserDataFromDatabase","userId","_response$data$users","console","log","response","get","process","env","REACT_APP_API_URL","headers","data","user","Array","isArray","find","u","id","_id","users","_user$profile","_user$profile2","_user$profile3","userData","email","username","name","profile","phone","addresses","_error$response","fetchOrders","params","includeUser","includeCustomer","ordersData","length","forEach","order","_order$user","_order$user2","_order$user2$profile","_order$user3","hasUserData","userEmail","userName","userProfile","getCustomerDisplayInfo","_order$user4","_order$user4$profile","_order$user5","initial","charAt","toUpperCase","nameFromEmail","split","sendEmailWithData","status","_userData$addresses","_userData$addresses2","orderDataForEmail","products","items","address","shippingAddress","totalAmount","amount","shipping","tax","createdAt","Date","toISOString","customerName","customerEmail","orderId","emailData","orderData","post","timeout","_error$response2","_error$response3","sendShippingEmail","_order$user6","_order$user7","_order$user8","_userData","emailError","sendCancellationWithData","_userData$addresses3","sendCancellationEmail","_order$user9","_order$user0","_order$user1","_userData2","updateOrderStatus","newStatus","updateResponse","put","emailSent","emailType","_error$response4","_error$response4$data","deleteOrder","delete","openDeleteModal","closeDeleteModal","openShippingModal","Math","random","toString","substr","now","closeShippingModal","handleShippingDataChange","field","value","prev","_objectSpread","handleShipOrder","cancelOrder","clearMessages","testEmailEndpoint","_userData$addresses4","testOrder","testData","_error$response5","_error$response5$data","children","onClick","style","marginLeft","background","border","color","cursor","marginBottom","marginRight","map","_order$id","customerInfo","slice","fontWeight","fontSize","className","paymentStatus","type","onChange","e","target","placeholder","required","padding","borderRadius","borderLeft","margin","disabled"],"sources":["D:/raju new 1/front-end/src/admin/pages/Orders.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Container = styled.div`\r\n  padding: 20px;\r\n  background: #f8f9fa;\r\n  min-height: 100vh;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 10px;\r\n  margin-bottom: 20px;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n`;\r\n\r\nconst Button = styled.button`\r\n  padding: 12px 24px;\r\n  background: #667eea;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  \r\n  &:hover {\r\n    background: #764ba2;\r\n  }\r\n`;\r\n\r\nconst OrdersTable = styled.div`\r\n  background: white;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n`;\r\n\r\nconst TableHeader = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;\r\n  padding: 15px 20px;\r\n  background: #f8f9fa;\r\n  font-weight: 600;\r\n  border-bottom: 1px solid #e9ecef;\r\n`;\r\n\r\nconst TableRow = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;\r\n  padding: 15px 20px;\r\n  border-bottom: 1px solid #e9ecef;\r\n  align-items: center;\r\n  \r\n  &:hover {\r\n    background: #f8f9fa;\r\n  }\r\n  \r\n  &:last-child {\r\n    border-bottom: none;\r\n  }\r\n`;\r\n\r\nconst StatusBadge = styled.span`\r\n  padding: 4px 12px;\r\n  border-radius: 20px;\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  \r\n  &.pending { background: #fff3cd; color: #856404; }\r\n  &.confirmed { background: #d1ecf1; color: #0c5460; }\r\n  &.shipped { background: #d4edda; color: #155724; }\r\n  &.delivered { background: #e2e3e5; color: #383d41; }\r\n  &.cancelled { background: #f8d7da; color: #721c24; }\r\n`;\r\n\r\nconst Loading = styled.div`\r\n  text-align: center;\r\n  padding: 50px;\r\n  font-size: 18px;\r\n  color: #666;\r\n`;\r\n\r\nconst EmptyState = styled.div`\r\n  text-align: center;\r\n  padding: 50px;\r\n  color: #666;\r\n`;\r\n\r\nconst ActionButton = styled.button`\r\n  padding: 6px 12px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  margin: 2px;\r\n  \r\n  &.primary { background: #007bff; color: white; }\r\n  &.success { background: #28a745; color: white; }\r\n  &.warning { background: #ffc107; color: black; }\r\n  &.danger { background: #dc3545; color: white; }\r\n`;\r\n\r\nconst Modal = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n`;\r\n\r\nconst ModalContent = styled.div`\r\n  background: white;\r\n  padding: 30px;\r\n  border-radius: 10px;\r\n  width: 90%;\r\n  max-width: 400px;\r\n  text-align: center;\r\n`;\r\n\r\nconst ModalActions = styled.div`\r\n  display: flex;\r\n  gap: 10px;\r\n  justify-content: center;\r\n  margin-top: 20px;\r\n`;\r\n\r\nconst ConfirmButton = styled.button`\r\n  padding: 10px 20px;\r\n  background: #dc3545;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n`;\r\n\r\nconst CancelButton = styled.button`\r\n  padding: 10px 20px;\r\n  background: #6c757d;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n`;\r\n\r\nconst SuccessMessage = styled.div`\r\n  background: #d4edda;\r\n  color: #155724;\r\n  padding: 12px;\r\n  border-radius: 6px;\r\n  margin-bottom: 20px;\r\n  border: 1px solid #c3e6cb;\r\n`;\r\n\r\nconst ErrorMessage = styled.div`\r\n  background: #f8d7da;\r\n  color: #721c24;\r\n  padding: 12px;\r\n  border-radius: 6px;\r\n  margin-bottom: 20px;\r\n  border: 1px solid #f5c6cb;\r\n`;\r\n\r\nconst ShippingModal = styled(Modal)``;\r\n\r\nconst ShippingModalContent = styled(ModalContent)`\r\n  max-width: 500px;\r\n  text-align: left;\r\n`;\r\n\r\nconst FormGroup = styled.div`\r\n  margin-bottom: 15px;\r\n`;\r\n\r\nconst Label = styled.label`\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: 600;\r\n  color: #333;\r\n`;\r\n\r\nconst Input = styled.input`\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  \r\n  &:focus {\r\n    outline: none;\r\n    border-color: #667eea;\r\n  }\r\n`;\r\n\r\nconst Select = styled.select`\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  \r\n  &:focus {\r\n    outline: none;\r\n    border-color: #667eea;\r\n  }\r\n`;\r\n\r\nconst CustomerInfo = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n`;\r\n\r\nconst CustomerAvatar = styled.div`\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  background: #667eea;\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-weight: 600;\r\n  font-size: 14px;\r\n`;\r\n\r\nconst AdminOrders = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [deleteModal, setDeleteModal] = useState(null);\r\n  const [shippingModal, setShippingModal] = useState(null);\r\n  const [message, setMessage] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [shippingData, setShippingData] = useState({\r\n    trackingNumber: '',\r\n    carrier: 'QuickCart Logistics',\r\n    estimatedDelivery: ''\r\n  });\r\n  const navigate = useNavigate();\r\n\r\n  const getAuthHeader = () => {\r\n    const token = localStorage.getItem('adminToken');\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n  };\r\n\r\n  // UPDATED: Function to get user data from database using profile system\r\n  const getUserDataFromDatabase = async (userId) => {\r\n    try {\r\n      console.log('🔍 Fetching user data for userId:', userId);\r\n      \r\n      // Get all users from auth service\r\n      const response = await axios.get(\r\n        `${process.env.REACT_APP_API_URL}/api/auth/users`,\r\n        { headers: getAuthHeader() }\r\n      );\r\n      \r\n      console.log('✅ Users data response:', response.data);\r\n      \r\n      // Find the user with matching ID - UPDATED for profile system\r\n      const user = Array.isArray(response.data) \r\n        ? response.data.find(u => u.id === userId || u._id === userId)\r\n        : response.data.users?.find(u => u.id === userId || u._id === userId);\r\n      \r\n      if (user) {\r\n        console.log('✅ User found with profile system:', user);\r\n        \r\n        // UPDATED: Extract data from profile system\r\n        const userData = {\r\n          email: user.email,\r\n          username: user.username,\r\n          name: user.profile?.name || '',\r\n          phone: user.profile?.phone || '',\r\n          // Addresses are now in profile.addresses\r\n          addresses: user.profile?.addresses || []\r\n        };\r\n        \r\n        console.log('📧 User data extracted:', userData);\r\n        return userData;\r\n      } else {\r\n        console.error('❌ User not found with ID:', userId);\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Failed to fetch users:', error);\r\n      console.error('Error details:', error.response?.data);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const fetchOrders = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get(\r\n        `${process.env.REACT_APP_API_URL}/api/orders/admin/all`,\r\n        { \r\n          headers: getAuthHeader(),\r\n          params: {\r\n            includeUser: true,\r\n            includeCustomer: true\r\n          }\r\n        }\r\n      );\r\n      \r\n      const ordersData = response.data.orders || response.data || [];\r\n      console.log('📦 Orders loaded:', ordersData.length);\r\n      \r\n      // UPDATED: Enhanced user data logging for profile system\r\n      if (ordersData.length > 0) {\r\n        console.log('🔍 Checking user data in orders (profile system):');\r\n        ordersData.forEach(order => {\r\n          console.log(`Order ${order.id}:`, {\r\n            userId: order.userId,\r\n            hasUserData: !!order.user,\r\n            userEmail: order.user?.email,\r\n            userName: order.user?.profile?.name,\r\n            userProfile: order.user?.profile\r\n          });\r\n        });\r\n      }\r\n      \r\n      setOrders(ordersData);\r\n    } catch (error) {\r\n      console.error('Error fetching orders:', error);\r\n      setError('Failed to load orders');\r\n      setOrders([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchOrders();\r\n  }, []);\r\n\r\n  // UPDATED: Helper to get customer display info\r\n  const getCustomerDisplayInfo = (order) => {\r\n    // Try to get from user profile first\r\n    if (order.user?.profile?.name) {\r\n      return {\r\n        name: order.user.profile.name,\r\n        email: order.user.email,\r\n        initial: order.user.profile.name.charAt(0).toUpperCase()\r\n      };\r\n    }\r\n    \r\n    // Fallback to email-based info\r\n    const email = order.userEmail || order.email || order.user?.email || 'Customer';\r\n    const nameFromEmail = email.split('@')[0];\r\n    \r\n    return {\r\n      name: nameFromEmail,\r\n      email: email,\r\n      initial: nameFromEmail.charAt(0).toUpperCase()\r\n    };\r\n  };\r\n\r\n  // UPDATED: Function to send email with profile system data\r\n  const sendEmailWithData = async (order, status, userEmail, userData) => {\r\n    try {\r\n      console.log('📤 Preparing to send email to:', userEmail);\r\n\r\n      // UPDATED: Prepare order data with profile system info\r\n      const orderDataForEmail = {\r\n        id: order.id,\r\n        products: order.products || order.items || [],\r\n        // UPDATED: Use profile addresses if available\r\n        address: userData?.addresses?.[0] || order.address || order.shippingAddress || {},\r\n        shippingAddress: order.shippingAddress || order.address || userData?.addresses?.[0] || {},\r\n        totalAmount: order.amount || order.totalAmount || 0,\r\n        shipping: order.shipping || 0,\r\n        tax: order.tax || 0,\r\n        trackingNumber: shippingData.trackingNumber,\r\n        carrier: shippingData.carrier,\r\n        estimatedDelivery: shippingData.estimatedDelivery,\r\n        status: status,\r\n        createdAt: order.createdAt || new Date().toISOString(),\r\n        // UPDATED: Include profile data\r\n        customerName: userData?.name || '',\r\n        customerEmail: userEmail,\r\n        userEmail: userEmail,\r\n        email: userEmail\r\n      };\r\n\r\n      console.log('📦 Final email data prepared with profile system:', {\r\n        orderId: orderDataForEmail.id,\r\n        userEmail: userEmail,\r\n        customerName: userData?.name,\r\n        status: status,\r\n        trackingNumber: shippingData.trackingNumber\r\n      });\r\n\r\n      const emailData = {\r\n        orderData: orderDataForEmail,\r\n        userEmail: userEmail,\r\n        status: status\r\n      };\r\n\r\n      console.log('🚀 Sending to endpoint:', `${process.env.REACT_APP_API_URL}/api/email/shipping-update`);\r\n      \r\n      const response = await axios.post(\r\n        `${process.env.REACT_APP_API_URL}/api/email/shipping-update`,\r\n        emailData,\r\n        { \r\n          headers: getAuthHeader(),\r\n          timeout: 15000\r\n        }\r\n      );\r\n\r\n      console.log('✅ Shipping email sent successfully:', response.data);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Email sending failed:', error);\r\n      console.error('Error details:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // UPDATED: Function to send shipping email with profile system\r\n  const sendShippingEmail = async (order, status) => {\r\n    try {\r\n      console.log('📧 Sending shipping email for order:', order.id, 'Status:', status);\r\n      \r\n      let userEmail = order.userEmail || order.email || order.customerEmail || order.user?.email;\r\n      let userData = null;\r\n      \r\n      console.log('📧 Email search results:', {\r\n        userEmail: userEmail,\r\n        user: order.user\r\n      });\r\n\r\n      // UPDATED: If no email found or we need profile data, fetch from database\r\n      if ((!userEmail || !order.user?.profile) && order.userId) {\r\n        console.log('🔍 Fetching user data from database for profile info...');\r\n        userData = await getUserDataFromDatabase(order.userId);\r\n        if (userData) {\r\n          userEmail = userData.email || userEmail;\r\n        }\r\n      } else if (order.user?.profile) {\r\n        // Use existing user profile data\r\n        userData = {\r\n          name: order.user.profile.name,\r\n          email: order.user.email,\r\n          addresses: order.user.profile.addresses\r\n        };\r\n      }\r\n\r\n      if (!userEmail) {\r\n        console.error('❌ No email found for order after database lookup.');\r\n        return false;\r\n      }\r\n\r\n      console.log('✅ Using user data:', { userEmail, userName: userData?.name });\r\n      return await sendEmailWithData(order, status, userEmail, userData);\r\n        \r\n    } catch (emailError) {\r\n      console.error('❌ Failed to send shipping email:', emailError);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // UPDATED: Similar updates for cancellation email...\r\n  const sendCancellationWithData = async (order, userEmail, userData) => {\r\n    try {\r\n      const emailData = {\r\n        orderData: {\r\n          id: order.id,\r\n          products: order.products || order.items || [],\r\n          // UPDATED: Use profile addresses\r\n          address: userData?.addresses?.[0] || order.address || order.shippingAddress || {},\r\n          totalAmount: order.amount || order.totalAmount || 0,\r\n          shipping: order.shipping || 0,\r\n          tax: order.tax || 0,\r\n          createdAt: order.createdAt || new Date().toISOString(),\r\n          customerName: userData?.name || '',\r\n          customerEmail: userEmail,\r\n          userEmail: userEmail\r\n        },\r\n        userEmail: userEmail\r\n      };\r\n\r\n      console.log('📤 Sending cancellation email with profile data...');\r\n\r\n      const response = await axios.post(\r\n        `${process.env.REACT_APP_API_URL}/api/email/order-cancellation`,\r\n        emailData,\r\n        { \r\n          headers: getAuthHeader(),\r\n          timeout: 15000\r\n        }\r\n      );\r\n\r\n      console.log('✅ Cancellation email sent successfully:', response.data);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Cancellation email sending failed:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const sendCancellationEmail = async (order) => {\r\n    try {\r\n      console.log('📧 Sending cancellation email for order:', order.id);\r\n      \r\n      let userEmail = order.userEmail || order.email || order.customerEmail || order.user?.email;\r\n      let userData = null;\r\n      \r\n      // UPDATED: Fetch profile data if needed\r\n      if ((!userEmail || !order.user?.profile) && order.userId) {\r\n        userData = await getUserDataFromDatabase(order.userId);\r\n        if (userData) {\r\n          userEmail = userData.email || userEmail;\r\n        }\r\n      } else if (order.user?.profile) {\r\n        userData = {\r\n          name: order.user.profile.name,\r\n          email: order.user.email,\r\n          addresses: order.user.profile.addresses\r\n        };\r\n      }\r\n\r\n      if (!userEmail) {\r\n        console.error('❌ No email found for order cancellation.');\r\n        return false;\r\n      }\r\n\r\n      console.log('✅ Using user data for cancellation:', { userEmail, userName: userData?.name });\r\n      return await sendCancellationWithData(order, userEmail, userData);\r\n    } catch (emailError) {\r\n      console.error('❌ Failed to send cancellation email:', emailError);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const updateOrderStatus = async (orderId, newStatus, order) => {\r\n    try {\r\n      console.log(`🔄 Updating order ${orderId} to status: ${newStatus}`);\r\n      \r\n      const updateResponse = await axios.put(\r\n        `${process.env.REACT_APP_API_URL}/api/orders/${orderId}/status`,\r\n        { status: newStatus },\r\n        { headers: getAuthHeader() }\r\n      );\r\n\r\n      console.log('✅ Order status updated in database:', updateResponse.data);\r\n\r\n      let emailSent = false;\r\n      let emailType = '';\r\n      \r\n      if (newStatus === 'shipped') {\r\n        emailSent = await sendShippingEmail(order, 'shipped');\r\n        emailType = 'shipping confirmation';\r\n      } else if (newStatus === 'delivered') {\r\n        emailSent = await sendShippingEmail(order, 'delivered');\r\n        emailType = 'delivery confirmation';\r\n      } else if (newStatus === 'cancelled') {\r\n        emailSent = await sendCancellationEmail(order);\r\n        emailType = 'cancellation';\r\n      }\r\n\r\n      setMessage(`Order status updated to ${newStatus}${emailSent ? ` and ${emailType} email sent` : ' (email failed - no user email found)'}`);\r\n      fetchOrders();\r\n      setShippingModal(null);\r\n    } catch (error) {\r\n      console.error('Error updating order:', error);\r\n      setError(`Failed to update order status: ${error.response?.data?.error || error.message}`);\r\n    }\r\n  };\r\n\r\n  const deleteOrder = async (orderId) => {\r\n    try {\r\n      await axios.delete(\r\n        `${process.env.REACT_APP_API_URL}/api/orders/${orderId}`,\r\n        { headers: getAuthHeader() }\r\n      );\r\n      setMessage('Order deleted successfully');\r\n      setDeleteModal(null);\r\n      fetchOrders();\r\n    } catch (error) {\r\n      console.error('Error deleting order:', error);\r\n      setError('Failed to delete order');\r\n      setDeleteModal(null);\r\n    }\r\n  };\r\n\r\n  const openDeleteModal = (order) => {\r\n    setDeleteModal(order);\r\n  };\r\n\r\n  const closeDeleteModal = () => {\r\n    setDeleteModal(null);\r\n  };\r\n\r\n  const openShippingModal = (order) => {\r\n    setShippingModal(order);\r\n    const trackingNumber = `TRK${Math.random().toString(36).substr(2, 9).toUpperCase()}`;\r\n    const estimatedDelivery = new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\r\n    \r\n    setShippingData({\r\n      trackingNumber: trackingNumber,\r\n      carrier: 'QuickCart Logistics',\r\n      estimatedDelivery: estimatedDelivery\r\n    });\r\n  };\r\n\r\n  const closeShippingModal = () => {\r\n    setShippingModal(null);\r\n    setShippingData({\r\n      trackingNumber: '',\r\n      carrier: 'QuickCart Logistics',\r\n      estimatedDelivery: ''\r\n    });\r\n  };\r\n\r\n  const handleShippingDataChange = (field, value) => {\r\n    setShippingData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handleShipOrder = () => {\r\n    if (shippingModal) {\r\n      updateOrderStatus(shippingModal.id, 'shipped', {\r\n        ...shippingModal,\r\n        trackingNumber: shippingData.trackingNumber,\r\n        carrier: shippingData.carrier\r\n      });\r\n    }\r\n  };\r\n\r\n  const cancelOrder = async (orderId, order) => {\r\n    try {\r\n      await axios.put(\r\n        `${process.env.REACT_APP_API_URL}/api/orders/${orderId}/status`,\r\n        { status: 'cancelled' },\r\n        { headers: getAuthHeader() }\r\n      );\r\n\r\n      const emailSent = await sendCancellationEmail(order);\r\n\r\n      setMessage(`Order cancelled${emailSent ? ' and cancellation email sent' : ' (email failed - no user email found)'}`);\r\n      fetchOrders();\r\n    } catch (error) {\r\n      console.error('Error cancelling order:', error);\r\n      setError('Failed to cancel order');\r\n    }\r\n  };\r\n\r\n  const clearMessages = () => {\r\n    setMessage('');\r\n    setError('');\r\n  };\r\n\r\n  // UPDATED: Test email endpoint with profile system\r\n  const testEmailEndpoint = async () => {\r\n    try {\r\n      console.log('🧪 Testing email endpoint with profile system...');\r\n      \r\n      const testOrder = orders.find(order => order.userId);\r\n      \r\n      if (!testOrder) {\r\n        setError('No orders with user data found to test email');\r\n        return false;\r\n      }\r\n\r\n      console.log('🔍 Testing with order:', testOrder.id, 'userId:', testOrder.userId);\r\n      \r\n      const userData = await getUserDataFromDatabase(testOrder.userId);\r\n      \r\n      if (!userData || !userData.email) {\r\n        setError('No user email found for testing');\r\n        return false;\r\n      }\r\n\r\n      const testData = {\r\n        orderData: {\r\n          id: testOrder.id,\r\n          products: testOrder.products || [],\r\n          address: userData.addresses?.[0] || testOrder.address || {},\r\n          totalAmount: testOrder.amount || testOrder.totalAmount || 0,\r\n          shipping: testOrder.shipping || 0,\r\n          tax: testOrder.tax || 0,\r\n          trackingNumber: 'TRKTEST123',\r\n          carrier: 'QuickCart Logistics',\r\n          status: 'shipped',\r\n          customerName: userData.name,\r\n          customerEmail: userData.email,\r\n          createdAt: testOrder.createdAt || new Date().toISOString()\r\n        },\r\n        userEmail: userData.email,\r\n        status: 'shipped'\r\n      };\r\n\r\n      const response = await axios.post(\r\n        `${process.env.REACT_APP_API_URL}/api/email/shipping-update`,\r\n        testData,\r\n        { \r\n          headers: getAuthHeader(),\r\n          timeout: 15000\r\n        }\r\n      );\r\n\r\n      console.log('✅ Test email endpoint response:', response.data);\r\n      setMessage(`Test email sent successfully to ${userData.email}!`);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Test email endpoint failed:', error);\r\n      setError(`Test email failed: ${error.response?.data?.error || error.message}`);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container>\r\n        <Header>\r\n          <h1>📋 Manage Orders</h1>\r\n        </Header>\r\n        <Loading>Loading orders from database...</Loading>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Header>\r\n        <h1>📋 Manage Orders</h1>\r\n        <Button onClick={() => navigate('/admin/dashboard')}>\r\n          ← Back to Dashboard\r\n        </Button>\r\n      </Header>\r\n\r\n      {message && (\r\n        <SuccessMessage>\r\n          ✅ {message}\r\n          <button onClick={clearMessages} style={{ marginLeft: '10px', background: 'none', border: 'none', color: '#155724', cursor: 'pointer' }}>\r\n            ×\r\n          </button>\r\n        </SuccessMessage>\r\n      )}\r\n\r\n      {error && (\r\n        <ErrorMessage>\r\n          ❌ {error}\r\n          <button onClick={clearMessages} style={{ marginLeft: '10px', background: 'none', border: 'none', color: '#721c24', cursor: 'pointer' }}>\r\n            ×\r\n          </button>\r\n        </ErrorMessage>\r\n      )}\r\n\r\n      <div style={{ marginBottom: '20px' }}>\r\n        <Button onClick={fetchOrders} style={{marginRight: '10px'}}>\r\n          🔄 Refresh Orders\r\n        </Button>\r\n        <Button onClick={testEmailEndpoint} style={{background: '#ffc107', color: 'black'}}>\r\n          🧪 Test Email Endpoint\r\n        </Button>\r\n      </div>\r\n\r\n      {orders.length === 0 ? (\r\n        <EmptyState>\r\n          <h3>No orders found</h3>\r\n          <p>Orders will appear here when customers make purchases</p>\r\n        </EmptyState>\r\n      ) : (\r\n        <OrdersTable>\r\n          <TableHeader>\r\n            <div>Order ID</div>\r\n            <div>Customer</div>\r\n            <div>Amount</div>\r\n            <div>Status</div>\r\n            <div>Payment</div>\r\n            <div>Actions</div>\r\n          </TableHeader>\r\n          \r\n          {orders.map((order) => {\r\n            const customerInfo = getCustomerDisplayInfo(order);\r\n            return (\r\n              <TableRow key={order.id}>\r\n                <div>#{order.id?.slice(-8) || 'N/A'}</div>\r\n                <div>\r\n                  <CustomerInfo>\r\n                    <CustomerAvatar>\r\n                      {customerInfo.initial}\r\n                    </CustomerAvatar>\r\n                    <div>\r\n                      <div style={{ fontWeight: '600', fontSize: '14px' }}>\r\n                        {customerInfo.name}\r\n                      </div>\r\n                      <div style={{ fontSize: '12px', color: '#666' }}>\r\n                        {customerInfo.email}\r\n                      </div>\r\n                    </div>\r\n                  </CustomerInfo>\r\n                </div>\r\n                <div>${order.amount || order.totalAmount || '0.00'}</div>\r\n                <div>\r\n                  <StatusBadge className={order.status}>\r\n                    {order.status}\r\n                  </StatusBadge>\r\n                </div>\r\n                <div>\r\n                  <StatusBadge className={order.paymentStatus}>\r\n                    {order.paymentStatus}\r\n                  </StatusBadge>\r\n                </div>\r\n                <div>\r\n                  <ActionButton \r\n                    className=\"primary\"\r\n                    onClick={() => navigate(`/orders`)}\r\n                  >\r\n                    View\r\n                  </ActionButton>\r\n                  \r\n                  {order.status === 'confirmed' && (\r\n                    <ActionButton \r\n                      className=\"success\"\r\n                      onClick={() => openShippingModal(order)}\r\n                    >\r\n                      Ship\r\n                    </ActionButton>\r\n                  )}\r\n                  \r\n                  {order.status === 'shipped' && (\r\n                    <ActionButton \r\n                      className=\"warning\"\r\n                      onClick={() => updateOrderStatus(order.id, 'delivered', order)}\r\n                    >\r\n                      Deliver\r\n                    </ActionButton>\r\n                  )}\r\n                  \r\n                  {order.status !== 'cancelled' && order.status !== 'delivered' && (\r\n                    <ActionButton \r\n                      className=\"danger\"\r\n                      onClick={() => cancelOrder(order.id, order)}\r\n                    >\r\n                      Cancel\r\n                    </ActionButton>\r\n                  )}\r\n                  \r\n                  <ActionButton \r\n                    className=\"danger\"\r\n                    onClick={() => openDeleteModal(order)}\r\n                  >\r\n                    Delete\r\n                  </ActionButton>\r\n                </div>\r\n              </TableRow>\r\n            );\r\n          })}\r\n        </OrdersTable>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {deleteModal && (\r\n        <Modal>\r\n          <ModalContent>\r\n            <h3>Confirm Order Deletion</h3>\r\n            <p>Are you sure you want to delete this order?</p>\r\n            <p><strong>Order ID:</strong> #{deleteModal.id?.slice(-8) || 'N/A'}</p>\r\n            <p><strong>Amount:</strong> ${deleteModal.amount || deleteModal.totalAmount}</p>\r\n            <p><strong>Status:</strong> {deleteModal.status}</p>\r\n            <p style={{ color: '#dc3545', fontWeight: '600' }}>\r\n              ⚠️ This action cannot be undone!\r\n            </p>\r\n            <ModalActions>\r\n              <ConfirmButton onClick={() => deleteOrder(deleteModal.id)}>\r\n                Delete Order\r\n              </ConfirmButton>\r\n              <CancelButton onClick={closeDeleteModal}>\r\n                Cancel\r\n              </CancelButton>\r\n            </ModalActions>\r\n          </ModalContent>\r\n        </Modal>\r\n      )}\r\n\r\n      {/* Shipping Modal */}\r\n      {shippingModal && (\r\n        <ShippingModal>\r\n          <ShippingModalContent>\r\n            <h3>🚚 Ship Order</h3>\r\n            <p>Shipping order #{shippingModal.id?.slice(-8) || 'N/A'}</p>\r\n            \r\n            {(() => {\r\n              const customerInfo = getCustomerDisplayInfo(shippingModal);\r\n              return (\r\n                <p>\r\n                  <strong>Customer:</strong> {customerInfo.name} ({customerInfo.email})\r\n                </p>\r\n              );\r\n            })()}\r\n            \r\n            <FormGroup>\r\n              <Label>Tracking Number *</Label>\r\n              <Input\r\n                type=\"text\"\r\n                value={shippingData.trackingNumber}\r\n                onChange={(e) => handleShippingDataChange('trackingNumber', e.target.value)}\r\n                placeholder=\"Enter tracking number\"\r\n                required\r\n              />\r\n            </FormGroup>\r\n            \r\n            <FormGroup>\r\n              <Label>Carrier *</Label>\r\n              <Select\r\n                value={shippingData.carrier}\r\n                onChange={(e) => handleShippingDataChange('carrier', e.target.value)}\r\n                required\r\n              >\r\n                <option value=\"QuickCart Logistics\">QuickCart Logistics</option>\r\n                <option value=\"FedEx\">FedEx</option>\r\n                <option value=\"UPS\">UPS</option>\r\n                <option value=\"USPS\">USPS</option>\r\n                <option value=\"DHL\">DHL</option>\r\n              </Select>\r\n            </FormGroup>\r\n            \r\n            <FormGroup>\r\n              <Label>Estimated Delivery *</Label>\r\n              <Input\r\n                type=\"date\"\r\n                value={shippingData.estimatedDelivery}\r\n                onChange={(e) => handleShippingDataChange('estimatedDelivery', e.target.value)}\r\n                required\r\n              />\r\n            </FormGroup>\r\n            \r\n            <div style={{ \r\n              background: '#e7f3ff', \r\n              padding: '15px', \r\n              borderRadius: '8px', \r\n              marginBottom: '20px',\r\n              borderLeft: '4px solid #007bff'\r\n            }}>\r\n              <h4 style={{ margin: '0 0 10px 0', color: '#004085' }}>📧 Email Notification</h4>\r\n              <p style={{ margin: '5px 0', fontSize: '14px', color: '#004085' }}>\r\n                A shipping confirmation email will be sent to the customer's registered email address\r\n              </p>\r\n            </div>\r\n            \r\n            <ModalActions>\r\n              <ConfirmButton \r\n                onClick={handleShipOrder}\r\n                style={{ background: '#28a745' }}\r\n                disabled={!shippingData.trackingNumber || !shippingData.carrier || !shippingData.estimatedDelivery}\r\n              >\r\n                Confirm Shipping & Send Email\r\n              </ConfirmButton>\r\n              <CancelButton onClick={closeShippingModal}>\r\n                Cancel\r\n              </CancelButton>\r\n            </ModalActions>\r\n          </ShippingModalContent>\r\n        </ShippingModal>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default AdminOrders;"],"mappings":"mqBAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,MAAM,KAAM,mBAAmB,CACtC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,SAAS,CAAGP,MAAM,CAACQ,GAAG,CAAAC,eAAA,GAAAA,eAAA,CAAAC,sBAAA,0EAI3B,CAED,KAAM,CAAAC,MAAM,CAAGX,MAAM,CAACQ,GAAG,CAAAI,gBAAA,GAAAA,gBAAA,CAAAF,sBAAA,0NASxB,CAED,KAAM,CAAAG,MAAM,CAAGb,MAAM,CAACc,MAAM,CAAAC,gBAAA,GAAAA,gBAAA,CAAAL,sBAAA,2MAY3B,CAED,KAAM,CAAAM,WAAW,CAAGhB,MAAM,CAACQ,GAAG,CAAAS,gBAAA,GAAAA,gBAAA,CAAAP,sBAAA,wHAK7B,CAED,KAAM,CAAAQ,WAAW,CAAGlB,MAAM,CAACQ,GAAG,CAAAW,gBAAA,GAAAA,gBAAA,CAAAT,sBAAA,wLAO7B,CAED,KAAM,CAAAU,QAAQ,CAAGpB,MAAM,CAACQ,GAAG,CAAAa,gBAAA,GAAAA,gBAAA,CAAAX,sBAAA,wQAc1B,CAED,KAAM,CAAAY,WAAW,CAAGtB,MAAM,CAACuB,IAAI,CAAAC,gBAAA,GAAAA,gBAAA,CAAAd,sBAAA,yXAW9B,CAED,KAAM,CAAAe,OAAO,CAAGzB,MAAM,CAACQ,GAAG,CAAAkB,gBAAA,GAAAA,gBAAA,CAAAhB,sBAAA,uFAKzB,CAED,KAAM,CAAAiB,UAAU,CAAG3B,MAAM,CAACQ,GAAG,CAAAoB,gBAAA,GAAAA,gBAAA,CAAAlB,sBAAA,mEAI5B,CAED,KAAM,CAAAmB,YAAY,CAAG7B,MAAM,CAACc,MAAM,CAAAgB,gBAAA,GAAAA,gBAAA,CAAApB,sBAAA,mVAYjC,CAED,KAAM,CAAAqB,KAAK,CAAG/B,MAAM,CAACQ,GAAG,CAAAwB,gBAAA,GAAAA,gBAAA,CAAAtB,sBAAA,iNAWvB,CAED,KAAM,CAAAuB,YAAY,CAAGjC,MAAM,CAACQ,GAAG,CAAA0B,iBAAA,GAAAA,iBAAA,CAAAxB,sBAAA,qIAO9B,CAED,KAAM,CAAAyB,YAAY,CAAGnC,MAAM,CAACQ,GAAG,CAAA4B,iBAAA,GAAAA,iBAAA,CAAA1B,sBAAA,2FAK9B,CAED,KAAM,CAAA2B,aAAa,CAAGrC,MAAM,CAACc,MAAM,CAAAwB,iBAAA,GAAAA,iBAAA,CAAA5B,sBAAA,2JAQlC,CAED,KAAM,CAAA6B,YAAY,CAAGvC,MAAM,CAACc,MAAM,CAAA0B,iBAAA,GAAAA,iBAAA,CAAA9B,sBAAA,2JAQjC,CAED,KAAM,CAAA+B,cAAc,CAAGzC,MAAM,CAACQ,GAAG,CAAAkC,iBAAA,GAAAA,iBAAA,CAAAhC,sBAAA,oJAOhC,CAED,KAAM,CAAAiC,YAAY,CAAG3C,MAAM,CAACQ,GAAG,CAAAoC,iBAAA,GAAAA,iBAAA,CAAAlC,sBAAA,oJAO9B,CAED,KAAM,CAAAmC,aAAa,CAAG7C,MAAM,CAAC+B,KAAK,CAAC,CAAAe,iBAAA,GAAAA,iBAAA,CAAApC,sBAAA,QAAE,CAErC,KAAM,CAAAqC,oBAAoB,CAAG/C,MAAM,CAACiC,YAAY,CAAC,CAAAe,iBAAA,GAAAA,iBAAA,CAAAtC,sBAAA,oDAGhD,CAED,KAAM,CAAAuC,SAAS,CAAGjD,MAAM,CAACQ,GAAG,CAAA0C,iBAAA,GAAAA,iBAAA,CAAAxC,sBAAA,kCAE3B,CAED,KAAM,CAAAyC,KAAK,CAAGnD,MAAM,CAACoD,KAAK,CAAAC,iBAAA,GAAAA,iBAAA,CAAA3C,sBAAA,yFAKzB,CAED,KAAM,CAAA4C,KAAK,CAAGtD,MAAM,CAACuD,KAAK,CAAAC,iBAAA,GAAAA,iBAAA,CAAA9C,sBAAA,4LAWzB,CAED,KAAM,CAAA+C,MAAM,CAAGzD,MAAM,CAAC0D,MAAM,CAAAC,iBAAA,GAAAA,iBAAA,CAAAjD,sBAAA,4LAW3B,CAED,KAAM,CAAAkD,YAAY,CAAG5D,MAAM,CAACQ,GAAG,CAAAqD,iBAAA,GAAAA,iBAAA,CAAAnD,sBAAA,kEAI9B,CAED,KAAM,CAAAoD,cAAc,CAAG9D,MAAM,CAACQ,GAAG,CAAAuD,iBAAA,GAAAA,iBAAA,CAAArD,sBAAA,0NAWhC,CAED,KAAM,CAAAsD,WAAW,CAAGA,CAAA,GAAM,KAAAC,eAAA,CAAAC,iBAAA,CACxB,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGtE,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACuE,OAAO,CAAEC,UAAU,CAAC,CAAGxE,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACyE,WAAW,CAAEC,cAAc,CAAC,CAAG1E,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC2E,aAAa,CAAEC,gBAAgB,CAAC,CAAG5E,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAAC6E,OAAO,CAAEC,UAAU,CAAC,CAAG9E,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAAC+E,KAAK,CAAEC,QAAQ,CAAC,CAAGhF,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACiF,YAAY,CAAEC,eAAe,CAAC,CAAGlF,QAAQ,CAAC,CAC/CmF,cAAc,CAAE,EAAE,CAClBC,OAAO,CAAE,qBAAqB,CAC9BC,iBAAiB,CAAE,EACrB,CAAC,CAAC,CACF,KAAM,CAAAC,QAAQ,CAAGlF,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAmF,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAChD,MAAO,CAAAF,KAAK,CAAG,CAAEG,aAAa,WAAAC,MAAA,CAAYJ,KAAK,CAAG,CAAC,CAAG,CAAC,CAAC,CAC1D,CAAC,CAED;AACA,KAAM,CAAAK,uBAAuB,CAAG,KAAO,CAAAC,MAAM,EAAK,CAChD,GAAI,KAAAC,oBAAA,CACFC,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAEH,MAAM,CAAC,CAExD;AACA,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAA/F,KAAK,CAACgG,GAAG,IAAAP,MAAA,CAC3BQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,oBAChC,CAAEC,OAAO,CAAEhB,aAAa,CAAC,CAAE,CAC7B,CAAC,CAEDS,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEC,QAAQ,CAACM,IAAI,CAAC,CAEpD;AACA,KAAM,CAAAC,IAAI,CAAGC,KAAK,CAACC,OAAO,CAACT,QAAQ,CAACM,IAAI,CAAC,CACrCN,QAAQ,CAACM,IAAI,CAACI,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKhB,MAAM,EAAIe,CAAC,CAACE,GAAG,GAAKjB,MAAM,CAAC,EAAAC,oBAAA,CAC5DG,QAAQ,CAACM,IAAI,CAACQ,KAAK,UAAAjB,oBAAA,iBAAnBA,oBAAA,CAAqBa,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACC,EAAE,GAAKhB,MAAM,EAAIe,CAAC,CAACE,GAAG,GAAKjB,MAAM,CAAC,CAEvE,GAAIW,IAAI,CAAE,KAAAQ,aAAA,CAAAC,cAAA,CAAAC,cAAA,CACRnB,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAEQ,IAAI,CAAC,CAEtD;AACA,KAAM,CAAAW,QAAQ,CAAG,CACfC,KAAK,CAAEZ,IAAI,CAACY,KAAK,CACjBC,QAAQ,CAAEb,IAAI,CAACa,QAAQ,CACvBC,IAAI,CAAE,EAAAN,aAAA,CAAAR,IAAI,CAACe,OAAO,UAAAP,aAAA,iBAAZA,aAAA,CAAcM,IAAI,GAAI,EAAE,CAC9BE,KAAK,CAAE,EAAAP,cAAA,CAAAT,IAAI,CAACe,OAAO,UAAAN,cAAA,iBAAZA,cAAA,CAAcO,KAAK,GAAI,EAAE,CAChC;AACAC,SAAS,CAAE,EAAAP,cAAA,CAAAV,IAAI,CAACe,OAAO,UAAAL,cAAA,iBAAZA,cAAA,CAAcO,SAAS,GAAI,EACxC,CAAC,CAED1B,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAEmB,QAAQ,CAAC,CAChD,MAAO,CAAAA,QAAQ,CACjB,CAAC,IAAM,CACLpB,OAAO,CAACjB,KAAK,CAAC,2BAA2B,CAAEe,MAAM,CAAC,CAClD,MAAO,KAAI,CACb,CACF,CAAE,MAAOf,KAAK,CAAE,KAAA4C,eAAA,CACd3B,OAAO,CAACjB,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDiB,OAAO,CAACjB,KAAK,CAAC,gBAAgB,EAAA4C,eAAA,CAAE5C,KAAK,CAACmB,QAAQ,UAAAyB,eAAA,iBAAdA,eAAA,CAAgBnB,IAAI,CAAC,CACrD,MAAO,KAAI,CACb,CACF,CAAC,CAED,KAAM,CAAAoB,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACFpD,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAA0B,QAAQ,CAAG,KAAM,CAAA/F,KAAK,CAACgG,GAAG,IAAAP,MAAA,CAC3BQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,0BAChC,CACEC,OAAO,CAAEhB,aAAa,CAAC,CAAC,CACxBsC,MAAM,CAAE,CACNC,WAAW,CAAE,IAAI,CACjBC,eAAe,CAAE,IACnB,CACF,CACF,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG9B,QAAQ,CAACM,IAAI,CAACnC,MAAM,EAAI6B,QAAQ,CAACM,IAAI,EAAI,EAAE,CAC9DR,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE+B,UAAU,CAACC,MAAM,CAAC,CAEnD;AACA,GAAID,UAAU,CAACC,MAAM,CAAG,CAAC,CAAE,CACzBjC,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC,CAChE+B,UAAU,CAACE,OAAO,CAACC,KAAK,EAAI,KAAAC,WAAA,CAAAC,YAAA,CAAAC,oBAAA,CAAAC,YAAA,CAC1BvC,OAAO,CAACC,GAAG,UAAAL,MAAA,CAAUuC,KAAK,CAACrB,EAAE,MAAK,CAChChB,MAAM,CAAEqC,KAAK,CAACrC,MAAM,CACpB0C,WAAW,CAAE,CAAC,CAACL,KAAK,CAAC1B,IAAI,CACzBgC,SAAS,EAAAL,WAAA,CAAED,KAAK,CAAC1B,IAAI,UAAA2B,WAAA,iBAAVA,WAAA,CAAYf,KAAK,CAC5BqB,QAAQ,EAAAL,YAAA,CAAEF,KAAK,CAAC1B,IAAI,UAAA4B,YAAA,kBAAAC,oBAAA,CAAVD,YAAA,CAAYb,OAAO,UAAAc,oBAAA,iBAAnBA,oBAAA,CAAqBf,IAAI,CACnCoB,WAAW,EAAAJ,YAAA,CAAEJ,KAAK,CAAC1B,IAAI,UAAA8B,YAAA,iBAAVA,YAAA,CAAYf,OAC3B,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAEAlD,SAAS,CAAC0D,UAAU,CAAC,CACvB,CAAE,MAAOjD,KAAK,CAAE,CACdiB,OAAO,CAACjB,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9CC,QAAQ,CAAC,uBAAuB,CAAC,CACjCV,SAAS,CAAC,EAAE,CAAC,CACf,CAAC,OAAS,CACRE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDvE,SAAS,CAAC,IAAM,CACd2H,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAgB,sBAAsB,CAAIT,KAAK,EAAK,KAAAU,YAAA,CAAAC,oBAAA,CAAAC,YAAA,CACxC;AACA,IAAAF,YAAA,CAAIV,KAAK,CAAC1B,IAAI,UAAAoC,YAAA,YAAAC,oBAAA,CAAVD,YAAA,CAAYrB,OAAO,UAAAsB,oBAAA,WAAnBA,oBAAA,CAAqBvB,IAAI,CAAE,CAC7B,MAAO,CACLA,IAAI,CAAEY,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACD,IAAI,CAC7BF,KAAK,CAAEc,KAAK,CAAC1B,IAAI,CAACY,KAAK,CACvB2B,OAAO,CAAEb,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACD,IAAI,CAAC0B,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CACzD,CAAC,CACH,CAEA;AACA,KAAM,CAAA7B,KAAK,CAAGc,KAAK,CAACM,SAAS,EAAIN,KAAK,CAACd,KAAK,IAAA0B,YAAA,CAAIZ,KAAK,CAAC1B,IAAI,UAAAsC,YAAA,iBAAVA,YAAA,CAAY1B,KAAK,GAAI,UAAU,CAC/E,KAAM,CAAA8B,aAAa,CAAG9B,KAAK,CAAC+B,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAEzC,MAAO,CACL7B,IAAI,CAAE4B,aAAa,CACnB9B,KAAK,CAAEA,KAAK,CACZ2B,OAAO,CAAEG,aAAa,CAACF,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAC/C,CAAC,CACH,CAAC,CAED;AACA,KAAM,CAAAG,iBAAiB,CAAG,KAAAA,CAAOlB,KAAK,CAAEmB,MAAM,CAAEb,SAAS,CAAErB,QAAQ,GAAK,CACtE,GAAI,KAAAmC,mBAAA,CAAAC,oBAAA,CACFxD,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEwC,SAAS,CAAC,CAExD;AACA,KAAM,CAAAgB,iBAAiB,CAAG,CACxB3C,EAAE,CAAEqB,KAAK,CAACrB,EAAE,CACZ4C,QAAQ,CAAEvB,KAAK,CAACuB,QAAQ,EAAIvB,KAAK,CAACwB,KAAK,EAAI,EAAE,CAC7C;AACAC,OAAO,CAAE,CAAAxC,QAAQ,SAARA,QAAQ,kBAAAmC,mBAAA,CAARnC,QAAQ,CAAEM,SAAS,UAAA6B,mBAAA,iBAAnBA,mBAAA,CAAsB,CAAC,CAAC,GAAIpB,KAAK,CAACyB,OAAO,EAAIzB,KAAK,CAAC0B,eAAe,EAAI,CAAC,CAAC,CACjFA,eAAe,CAAE1B,KAAK,CAAC0B,eAAe,EAAI1B,KAAK,CAACyB,OAAO,GAAIxC,QAAQ,SAARA,QAAQ,kBAAAoC,oBAAA,CAARpC,QAAQ,CAAEM,SAAS,UAAA8B,oBAAA,iBAAnBA,oBAAA,CAAsB,CAAC,CAAC,GAAI,CAAC,CAAC,CACzFM,WAAW,CAAE3B,KAAK,CAAC4B,MAAM,EAAI5B,KAAK,CAAC2B,WAAW,EAAI,CAAC,CACnDE,QAAQ,CAAE7B,KAAK,CAAC6B,QAAQ,EAAI,CAAC,CAC7BC,GAAG,CAAE9B,KAAK,CAAC8B,GAAG,EAAI,CAAC,CACnB9E,cAAc,CAAEF,YAAY,CAACE,cAAc,CAC3CC,OAAO,CAAEH,YAAY,CAACG,OAAO,CAC7BC,iBAAiB,CAAEJ,YAAY,CAACI,iBAAiB,CACjDiE,MAAM,CAAEA,MAAM,CACdY,SAAS,CAAE/B,KAAK,CAAC+B,SAAS,EAAI,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACtD;AACAC,YAAY,CAAE,CAAAjD,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEG,IAAI,GAAI,EAAE,CAClC+C,aAAa,CAAE7B,SAAS,CACxBA,SAAS,CAAEA,SAAS,CACpBpB,KAAK,CAAEoB,SACT,CAAC,CAEDzC,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAE,CAC/DsE,OAAO,CAAEd,iBAAiB,CAAC3C,EAAE,CAC7B2B,SAAS,CAAEA,SAAS,CACpB4B,YAAY,CAAEjD,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEG,IAAI,CAC5B+B,MAAM,CAAEA,MAAM,CACdnE,cAAc,CAAEF,YAAY,CAACE,cAC/B,CAAC,CAAC,CAEF,KAAM,CAAAqF,SAAS,CAAG,CAChBC,SAAS,CAAEhB,iBAAiB,CAC5BhB,SAAS,CAAEA,SAAS,CACpBa,MAAM,CAAEA,MACV,CAAC,CAEDtD,OAAO,CAACC,GAAG,CAAC,yBAAyB,IAAAL,MAAA,CAAKQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,8BAA4B,CAAC,CAEpG,KAAM,CAAAJ,QAAQ,CAAG,KAAM,CAAA/F,KAAK,CAACuK,IAAI,IAAA9E,MAAA,CAC5BQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,+BAChCkE,SAAS,CACT,CACEjE,OAAO,CAAEhB,aAAa,CAAC,CAAC,CACxBoF,OAAO,CAAE,KACX,CACF,CAAC,CAED3E,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAEC,QAAQ,CAACM,IAAI,CAAC,CACjE,MAAO,KAAI,CACb,CAAE,MAAOzB,KAAK,CAAE,KAAA6F,gBAAA,CAAAC,gBAAA,CACd7E,OAAO,CAACjB,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/CiB,OAAO,CAACjB,KAAK,CAAC,gBAAgB,CAAE,CAC9BF,OAAO,CAAEE,KAAK,CAACF,OAAO,CACtBqB,QAAQ,EAAA0E,gBAAA,CAAE7F,KAAK,CAACmB,QAAQ,UAAA0E,gBAAA,iBAAdA,gBAAA,CAAgBpE,IAAI,CAC9B8C,MAAM,EAAAuB,gBAAA,CAAE9F,KAAK,CAACmB,QAAQ,UAAA2E,gBAAA,iBAAdA,gBAAA,CAAgBvB,MAC1B,CAAC,CAAC,CACF,MAAO,MAAK,CACd,CACF,CAAC,CAED;AACA,KAAM,CAAAwB,iBAAiB,CAAG,KAAAA,CAAO3C,KAAK,CAAEmB,MAAM,GAAK,CACjD,GAAI,KAAAyB,YAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,SAAA,CACFlF,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAEkC,KAAK,CAACrB,EAAE,CAAE,SAAS,CAAEwC,MAAM,CAAC,CAEhF,GAAI,CAAAb,SAAS,CAAGN,KAAK,CAACM,SAAS,EAAIN,KAAK,CAACd,KAAK,EAAIc,KAAK,CAACmC,aAAa,IAAAS,YAAA,CAAI5C,KAAK,CAAC1B,IAAI,UAAAsE,YAAA,iBAAVA,YAAA,CAAY1D,KAAK,EAC1F,GAAI,CAAAD,QAAQ,CAAG,IAAI,CAEnBpB,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAE,CACtCwC,SAAS,CAAEA,SAAS,CACpBhC,IAAI,CAAE0B,KAAK,CAAC1B,IACd,CAAC,CAAC,CAEF;AACA,GAAI,CAAC,CAACgC,SAAS,EAAI,GAAAuC,YAAA,CAAC7C,KAAK,CAAC1B,IAAI,UAAAuE,YAAA,WAAVA,YAAA,CAAYxD,OAAO,IAAKW,KAAK,CAACrC,MAAM,CAAE,CACxDE,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC,CACtEmB,QAAQ,CAAG,KAAM,CAAAvB,uBAAuB,CAACsC,KAAK,CAACrC,MAAM,CAAC,CACtD,GAAIsB,QAAQ,CAAE,CACZqB,SAAS,CAAGrB,QAAQ,CAACC,KAAK,EAAIoB,SAAS,CACzC,CACF,CAAC,IAAM,KAAAwC,YAAA,CAAI9C,KAAK,CAAC1B,IAAI,UAAAwE,YAAA,WAAVA,YAAA,CAAYzD,OAAO,CAAE,CAC9B;AACAJ,QAAQ,CAAG,CACTG,IAAI,CAAEY,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACD,IAAI,CAC7BF,KAAK,CAAEc,KAAK,CAAC1B,IAAI,CAACY,KAAK,CACvBK,SAAS,CAAES,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACE,SAChC,CAAC,CACH,CAEA,GAAI,CAACe,SAAS,CAAE,CACdzC,OAAO,CAACjB,KAAK,CAAC,mDAAmD,CAAC,CAClE,MAAO,MAAK,CACd,CAEAiB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAE,CAAEwC,SAAS,CAAEC,QAAQ,EAAAwC,SAAA,CAAE9D,QAAQ,UAAA8D,SAAA,iBAARA,SAAA,CAAU3D,IAAK,CAAC,CAAC,CAC1E,MAAO,MAAM,CAAA8B,iBAAiB,CAAClB,KAAK,CAAEmB,MAAM,CAAEb,SAAS,CAAErB,QAAQ,CAAC,CAEpE,CAAE,MAAO+D,UAAU,CAAE,CACnBnF,OAAO,CAACjB,KAAK,CAAC,kCAAkC,CAAEoG,UAAU,CAAC,CAC7D,MAAO,MAAK,CACd,CACF,CAAC,CAED;AACA,KAAM,CAAAC,wBAAwB,CAAG,KAAAA,CAAOjD,KAAK,CAAEM,SAAS,CAAErB,QAAQ,GAAK,CACrE,GAAI,KAAAiE,oBAAA,CACF,KAAM,CAAAb,SAAS,CAAG,CAChBC,SAAS,CAAE,CACT3D,EAAE,CAAEqB,KAAK,CAACrB,EAAE,CACZ4C,QAAQ,CAAEvB,KAAK,CAACuB,QAAQ,EAAIvB,KAAK,CAACwB,KAAK,EAAI,EAAE,CAC7C;AACAC,OAAO,CAAE,CAAAxC,QAAQ,SAARA,QAAQ,kBAAAiE,oBAAA,CAARjE,QAAQ,CAAEM,SAAS,UAAA2D,oBAAA,iBAAnBA,oBAAA,CAAsB,CAAC,CAAC,GAAIlD,KAAK,CAACyB,OAAO,EAAIzB,KAAK,CAAC0B,eAAe,EAAI,CAAC,CAAC,CACjFC,WAAW,CAAE3B,KAAK,CAAC4B,MAAM,EAAI5B,KAAK,CAAC2B,WAAW,EAAI,CAAC,CACnDE,QAAQ,CAAE7B,KAAK,CAAC6B,QAAQ,EAAI,CAAC,CAC7BC,GAAG,CAAE9B,KAAK,CAAC8B,GAAG,EAAI,CAAC,CACnBC,SAAS,CAAE/B,KAAK,CAAC+B,SAAS,EAAI,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACtDC,YAAY,CAAE,CAAAjD,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEG,IAAI,GAAI,EAAE,CAClC+C,aAAa,CAAE7B,SAAS,CACxBA,SAAS,CAAEA,SACb,CAAC,CACDA,SAAS,CAAEA,SACb,CAAC,CAEDzC,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC,CAEjE,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAA/F,KAAK,CAACuK,IAAI,IAAA9E,MAAA,CAC5BQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,kCAChCkE,SAAS,CACT,CACEjE,OAAO,CAAEhB,aAAa,CAAC,CAAC,CACxBoF,OAAO,CAAE,KACX,CACF,CAAC,CAED3E,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAEC,QAAQ,CAACM,IAAI,CAAC,CACrE,MAAO,KAAI,CACb,CAAE,MAAOzB,KAAK,CAAE,CACdiB,OAAO,CAACjB,KAAK,CAAC,sCAAsC,CAAEA,KAAK,CAAC,CAC5D,MAAO,MAAK,CACd,CACF,CAAC,CAED,KAAM,CAAAuG,qBAAqB,CAAG,KAAO,CAAAnD,KAAK,EAAK,CAC7C,GAAI,KAAAoD,YAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,UAAA,CACF1F,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAEkC,KAAK,CAACrB,EAAE,CAAC,CAEjE,GAAI,CAAA2B,SAAS,CAAGN,KAAK,CAACM,SAAS,EAAIN,KAAK,CAACd,KAAK,EAAIc,KAAK,CAACmC,aAAa,IAAAiB,YAAA,CAAIpD,KAAK,CAAC1B,IAAI,UAAA8E,YAAA,iBAAVA,YAAA,CAAYlE,KAAK,EAC1F,GAAI,CAAAD,QAAQ,CAAG,IAAI,CAEnB;AACA,GAAI,CAAC,CAACqB,SAAS,EAAI,GAAA+C,YAAA,CAACrD,KAAK,CAAC1B,IAAI,UAAA+E,YAAA,WAAVA,YAAA,CAAYhE,OAAO,IAAKW,KAAK,CAACrC,MAAM,CAAE,CACxDsB,QAAQ,CAAG,KAAM,CAAAvB,uBAAuB,CAACsC,KAAK,CAACrC,MAAM,CAAC,CACtD,GAAIsB,QAAQ,CAAE,CACZqB,SAAS,CAAGrB,QAAQ,CAACC,KAAK,EAAIoB,SAAS,CACzC,CACF,CAAC,IAAM,KAAAgD,YAAA,CAAItD,KAAK,CAAC1B,IAAI,UAAAgF,YAAA,WAAVA,YAAA,CAAYjE,OAAO,CAAE,CAC9BJ,QAAQ,CAAG,CACTG,IAAI,CAAEY,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACD,IAAI,CAC7BF,KAAK,CAAEc,KAAK,CAAC1B,IAAI,CAACY,KAAK,CACvBK,SAAS,CAAES,KAAK,CAAC1B,IAAI,CAACe,OAAO,CAACE,SAChC,CAAC,CACH,CAEA,GAAI,CAACe,SAAS,CAAE,CACdzC,OAAO,CAACjB,KAAK,CAAC,0CAA0C,CAAC,CACzD,MAAO,MAAK,CACd,CAEAiB,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAE,CAAEwC,SAAS,CAAEC,QAAQ,EAAAgD,UAAA,CAAEtE,QAAQ,UAAAsE,UAAA,iBAARA,UAAA,CAAUnE,IAAK,CAAC,CAAC,CAC3F,MAAO,MAAM,CAAA6D,wBAAwB,CAACjD,KAAK,CAAEM,SAAS,CAAErB,QAAQ,CAAC,CACnE,CAAE,MAAO+D,UAAU,CAAE,CACnBnF,OAAO,CAACjB,KAAK,CAAC,sCAAsC,CAAEoG,UAAU,CAAC,CACjE,MAAO,MAAK,CACd,CACF,CAAC,CAED,KAAM,CAAAQ,iBAAiB,CAAG,KAAAA,CAAOpB,OAAO,CAAEqB,SAAS,CAAEzD,KAAK,GAAK,CAC7D,GAAI,CACFnC,OAAO,CAACC,GAAG,gCAAAL,MAAA,CAAsB2E,OAAO,iBAAA3E,MAAA,CAAegG,SAAS,CAAE,CAAC,CAEnE,KAAM,CAAAC,cAAc,CAAG,KAAM,CAAA1L,KAAK,CAAC2L,GAAG,IAAAlG,MAAA,CACjCQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,iBAAAV,MAAA,CAAe2E,OAAO,YACtD,CAAEjB,MAAM,CAAEsC,SAAU,CAAC,CACrB,CAAErF,OAAO,CAAEhB,aAAa,CAAC,CAAE,CAC7B,CAAC,CAEDS,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAE4F,cAAc,CAACrF,IAAI,CAAC,CAEvE,GAAI,CAAAuF,SAAS,CAAG,KAAK,CACrB,GAAI,CAAAC,SAAS,CAAG,EAAE,CAElB,GAAIJ,SAAS,GAAK,SAAS,CAAE,CAC3BG,SAAS,CAAG,KAAM,CAAAjB,iBAAiB,CAAC3C,KAAK,CAAE,SAAS,CAAC,CACrD6D,SAAS,CAAG,uBAAuB,CACrC,CAAC,IAAM,IAAIJ,SAAS,GAAK,WAAW,CAAE,CACpCG,SAAS,CAAG,KAAM,CAAAjB,iBAAiB,CAAC3C,KAAK,CAAE,WAAW,CAAC,CACvD6D,SAAS,CAAG,uBAAuB,CACrC,CAAC,IAAM,IAAIJ,SAAS,GAAK,WAAW,CAAE,CACpCG,SAAS,CAAG,KAAM,CAAAT,qBAAqB,CAACnD,KAAK,CAAC,CAC9C6D,SAAS,CAAG,cAAc,CAC5B,CAEAlH,UAAU,4BAAAc,MAAA,CAA4BgG,SAAS,EAAAhG,MAAA,CAAGmG,SAAS,SAAAnG,MAAA,CAAWoG,SAAS,gBAAgB,uCAAuC,CAAE,CAAC,CACzIpE,WAAW,CAAC,CAAC,CACbhD,gBAAgB,CAAC,IAAI,CAAC,CACxB,CAAE,MAAOG,KAAK,CAAE,KAAAkH,gBAAA,CAAAC,qBAAA,CACdlG,OAAO,CAACjB,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,QAAQ,mCAAAY,MAAA,CAAmC,EAAAqG,gBAAA,CAAAlH,KAAK,CAACmB,QAAQ,UAAA+F,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBzF,IAAI,UAAA0F,qBAAA,iBAApBA,qBAAA,CAAsBnH,KAAK,GAAIA,KAAK,CAACF,OAAO,CAAE,CAAC,CAC5F,CACF,CAAC,CAED,KAAM,CAAAsH,WAAW,CAAG,KAAO,CAAA5B,OAAO,EAAK,CACrC,GAAI,CACF,KAAM,CAAApK,KAAK,CAACiM,MAAM,IAAAxG,MAAA,CACbQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,iBAAAV,MAAA,CAAe2E,OAAO,EACtD,CAAEhE,OAAO,CAAEhB,aAAa,CAAC,CAAE,CAC7B,CAAC,CACDT,UAAU,CAAC,4BAA4B,CAAC,CACxCJ,cAAc,CAAC,IAAI,CAAC,CACpBkD,WAAW,CAAC,CAAC,CACf,CAAE,MAAO7C,KAAK,CAAE,CACdiB,OAAO,CAACjB,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,QAAQ,CAAC,wBAAwB,CAAC,CAClCN,cAAc,CAAC,IAAI,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAA2H,eAAe,CAAIlE,KAAK,EAAK,CACjCzD,cAAc,CAACyD,KAAK,CAAC,CACvB,CAAC,CAED,KAAM,CAAAmE,gBAAgB,CAAGA,CAAA,GAAM,CAC7B5H,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,CAED,KAAM,CAAA6H,iBAAiB,CAAIpE,KAAK,EAAK,CACnCvD,gBAAgB,CAACuD,KAAK,CAAC,CACvB,KAAM,CAAAhD,cAAc,OAAAS,MAAA,CAAS4G,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAACzD,WAAW,CAAC,CAAC,CAAE,CACpF,KAAM,CAAA7D,iBAAiB,CAAG,GAAI,CAAA8E,IAAI,CAACA,IAAI,CAACyC,GAAG,CAAC,CAAC,CAAG,CAAC,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CAACxC,WAAW,CAAC,CAAC,CAAChB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAEpGlE,eAAe,CAAC,CACdC,cAAc,CAAEA,cAAc,CAC9BC,OAAO,CAAE,qBAAqB,CAC9BC,iBAAiB,CAAEA,iBACrB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAwH,kBAAkB,CAAGA,CAAA,GAAM,CAC/BjI,gBAAgB,CAAC,IAAI,CAAC,CACtBM,eAAe,CAAC,CACdC,cAAc,CAAE,EAAE,CAClBC,OAAO,CAAE,qBAAqB,CAC9BC,iBAAiB,CAAE,EACrB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAyH,wBAAwB,CAAGA,CAACC,KAAK,CAAEC,KAAK,GAAK,CACjD9H,eAAe,CAAC+H,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACfD,IAAI,MACP,CAACF,KAAK,EAAGC,KAAK,EACd,CAAC,CACL,CAAC,CAED,KAAM,CAAAG,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAIxI,aAAa,CAAE,CACjBgH,iBAAiB,CAAChH,aAAa,CAACmC,EAAE,CAAE,SAAS,CAAAoG,aAAA,CAAAA,aAAA,IACxCvI,aAAa,MAChBQ,cAAc,CAAEF,YAAY,CAACE,cAAc,CAC3CC,OAAO,CAAEH,YAAY,CAACG,OAAO,EAC9B,CAAC,CACJ,CACF,CAAC,CAED,KAAM,CAAAgI,WAAW,CAAG,KAAAA,CAAO7C,OAAO,CAAEpC,KAAK,GAAK,CAC5C,GAAI,CACF,KAAM,CAAAhI,KAAK,CAAC2L,GAAG,IAAAlG,MAAA,CACVQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,iBAAAV,MAAA,CAAe2E,OAAO,YACtD,CAAEjB,MAAM,CAAE,WAAY,CAAC,CACvB,CAAE/C,OAAO,CAAEhB,aAAa,CAAC,CAAE,CAC7B,CAAC,CAED,KAAM,CAAAwG,SAAS,CAAG,KAAM,CAAAT,qBAAqB,CAACnD,KAAK,CAAC,CAEpDrD,UAAU,mBAAAc,MAAA,CAAmBmG,SAAS,CAAG,8BAA8B,CAAG,uCAAuC,CAAE,CAAC,CACpHnE,WAAW,CAAC,CAAC,CACf,CAAE,MAAO7C,KAAK,CAAE,CACdiB,OAAO,CAACjB,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/CC,QAAQ,CAAC,wBAAwB,CAAC,CACpC,CACF,CAAC,CAED,KAAM,CAAAqI,aAAa,CAAGA,CAAA,GAAM,CAC1BvI,UAAU,CAAC,EAAE,CAAC,CACdE,QAAQ,CAAC,EAAE,CAAC,CACd,CAAC,CAED;AACA,KAAM,CAAAsI,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,KAAAC,oBAAA,CACFvH,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC,CAE/D,KAAM,CAAAuH,SAAS,CAAGnJ,MAAM,CAACuC,IAAI,CAACuB,KAAK,EAAIA,KAAK,CAACrC,MAAM,CAAC,CAEpD,GAAI,CAAC0H,SAAS,CAAE,CACdxI,QAAQ,CAAC,8CAA8C,CAAC,CACxD,MAAO,MAAK,CACd,CAEAgB,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEuH,SAAS,CAAC1G,EAAE,CAAE,SAAS,CAAE0G,SAAS,CAAC1H,MAAM,CAAC,CAEhF,KAAM,CAAAsB,QAAQ,CAAG,KAAM,CAAAvB,uBAAuB,CAAC2H,SAAS,CAAC1H,MAAM,CAAC,CAEhE,GAAI,CAACsB,QAAQ,EAAI,CAACA,QAAQ,CAACC,KAAK,CAAE,CAChCrC,QAAQ,CAAC,iCAAiC,CAAC,CAC3C,MAAO,MAAK,CACd,CAEA,KAAM,CAAAyI,QAAQ,CAAG,CACfhD,SAAS,CAAE,CACT3D,EAAE,CAAE0G,SAAS,CAAC1G,EAAE,CAChB4C,QAAQ,CAAE8D,SAAS,CAAC9D,QAAQ,EAAI,EAAE,CAClCE,OAAO,CAAE,EAAA2D,oBAAA,CAAAnG,QAAQ,CAACM,SAAS,UAAA6F,oBAAA,iBAAlBA,oBAAA,CAAqB,CAAC,CAAC,GAAIC,SAAS,CAAC5D,OAAO,EAAI,CAAC,CAAC,CAC3DE,WAAW,CAAE0D,SAAS,CAACzD,MAAM,EAAIyD,SAAS,CAAC1D,WAAW,EAAI,CAAC,CAC3DE,QAAQ,CAAEwD,SAAS,CAACxD,QAAQ,EAAI,CAAC,CACjCC,GAAG,CAAEuD,SAAS,CAACvD,GAAG,EAAI,CAAC,CACvB9E,cAAc,CAAE,YAAY,CAC5BC,OAAO,CAAE,qBAAqB,CAC9BkE,MAAM,CAAE,SAAS,CACjBe,YAAY,CAAEjD,QAAQ,CAACG,IAAI,CAC3B+C,aAAa,CAAElD,QAAQ,CAACC,KAAK,CAC7B6C,SAAS,CAAEsD,SAAS,CAACtD,SAAS,EAAI,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAC3D,CAAC,CACD3B,SAAS,CAAErB,QAAQ,CAACC,KAAK,CACzBiC,MAAM,CAAE,SACV,CAAC,CAED,KAAM,CAAApD,QAAQ,CAAG,KAAM,CAAA/F,KAAK,CAACuK,IAAI,IAAA9E,MAAA,CAC5BQ,OAAO,CAACC,GAAG,CAACC,iBAAiB,+BAChCmH,QAAQ,CACR,CACElH,OAAO,CAAEhB,aAAa,CAAC,CAAC,CACxBoF,OAAO,CAAE,KACX,CACF,CAAC,CAED3E,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAEC,QAAQ,CAACM,IAAI,CAAC,CAC7D1B,UAAU,oCAAAc,MAAA,CAAoCwB,QAAQ,CAACC,KAAK,KAAG,CAAC,CAChE,MAAO,KAAI,CACb,CAAE,MAAOtC,KAAK,CAAE,KAAA2I,gBAAA,CAAAC,qBAAA,CACd3H,OAAO,CAACjB,KAAK,CAAC,+BAA+B,CAAEA,KAAK,CAAC,CACrDC,QAAQ,uBAAAY,MAAA,CAAuB,EAAA8H,gBAAA,CAAA3I,KAAK,CAACmB,QAAQ,UAAAwH,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBlH,IAAI,UAAAmH,qBAAA,iBAApBA,qBAAA,CAAsB5I,KAAK,GAAIA,KAAK,CAACF,OAAO,CAAE,CAAC,CAC9E,MAAO,MAAK,CACd,CACF,CAAC,CAED,GAAIN,OAAO,CAAE,CACX,mBACE/D,KAAA,CAACC,SAAS,EAAAmN,QAAA,eACRtN,IAAA,CAACO,MAAM,EAAA+M,QAAA,cACLtN,IAAA,OAAAsN,QAAA,CAAI,4BAAgB,CAAI,CAAC,CACnB,CAAC,cACTtN,IAAA,CAACqB,OAAO,EAAAiM,QAAA,CAAC,iCAA+B,CAAS,CAAC,EACzC,CAAC,CAEhB,CAEA,mBACEpN,KAAA,CAACC,SAAS,EAAAmN,QAAA,eACRpN,KAAA,CAACK,MAAM,EAAA+M,QAAA,eACLtN,IAAA,OAAAsN,QAAA,CAAI,4BAAgB,CAAI,CAAC,cACzBtN,IAAA,CAACS,MAAM,EAAC8M,OAAO,CAAEA,CAAA,GAAMvI,QAAQ,CAAC,kBAAkB,CAAE,CAAAsI,QAAA,CAAC,0BAErD,CAAQ,CAAC,EACH,CAAC,CAER/I,OAAO,eACNrE,KAAA,CAACmC,cAAc,EAAAiL,QAAA,EAAC,SACZ,CAAC/I,OAAO,cACVvE,IAAA,WAAQuN,OAAO,CAAER,aAAc,CAACS,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAM,CAAEC,UAAU,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAS,CAAEC,MAAM,CAAE,SAAU,CAAE,CAAAP,QAAA,CAAC,MAExI,CAAQ,CAAC,EACK,CACjB,CAEA7I,KAAK,eACJvE,KAAA,CAACqC,YAAY,EAAA+K,QAAA,EAAC,SACV,CAAC7I,KAAK,cACRzE,IAAA,WAAQuN,OAAO,CAAER,aAAc,CAACS,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAM,CAAEC,UAAU,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAS,CAAEC,MAAM,CAAE,SAAU,CAAE,CAAAP,QAAA,CAAC,MAExI,CAAQ,CAAC,EACG,CACf,cAEDpN,KAAA,QAAKsN,KAAK,CAAE,CAAEM,YAAY,CAAE,MAAO,CAAE,CAAAR,QAAA,eACnCtN,IAAA,CAACS,MAAM,EAAC8M,OAAO,CAAEjG,WAAY,CAACkG,KAAK,CAAE,CAACO,WAAW,CAAE,MAAM,CAAE,CAAAT,QAAA,CAAC,6BAE5D,CAAQ,CAAC,cACTtN,IAAA,CAACS,MAAM,EAAC8M,OAAO,CAAEP,iBAAkB,CAACQ,KAAK,CAAE,CAACE,UAAU,CAAE,SAAS,CAAEE,KAAK,CAAE,OAAO,CAAE,CAAAN,QAAA,CAAC,kCAEpF,CAAQ,CAAC,EACN,CAAC,CAELvJ,MAAM,CAAC4D,MAAM,GAAK,CAAC,cAClBzH,KAAA,CAACqB,UAAU,EAAA+L,QAAA,eACTtN,IAAA,OAAAsN,QAAA,CAAI,iBAAe,CAAI,CAAC,cACxBtN,IAAA,MAAAsN,QAAA,CAAG,uDAAqD,CAAG,CAAC,EAClD,CAAC,cAEbpN,KAAA,CAACU,WAAW,EAAA0M,QAAA,eACVpN,KAAA,CAACY,WAAW,EAAAwM,QAAA,eACVtN,IAAA,QAAAsN,QAAA,CAAK,UAAQ,CAAK,CAAC,cACnBtN,IAAA,QAAAsN,QAAA,CAAK,UAAQ,CAAK,CAAC,cACnBtN,IAAA,QAAAsN,QAAA,CAAK,QAAM,CAAK,CAAC,cACjBtN,IAAA,QAAAsN,QAAA,CAAK,QAAM,CAAK,CAAC,cACjBtN,IAAA,QAAAsN,QAAA,CAAK,SAAO,CAAK,CAAC,cAClBtN,IAAA,QAAAsN,QAAA,CAAK,SAAO,CAAK,CAAC,EACP,CAAC,CAEbvJ,MAAM,CAACiK,GAAG,CAAEnG,KAAK,EAAK,KAAAoG,SAAA,CACrB,KAAM,CAAAC,YAAY,CAAG5F,sBAAsB,CAACT,KAAK,CAAC,CAClD,mBACE3H,KAAA,CAACc,QAAQ,EAAAsM,QAAA,eACPpN,KAAA,QAAAoN,QAAA,EAAK,GAAC,CAAC,EAAAW,SAAA,CAAApG,KAAK,CAACrB,EAAE,UAAAyH,SAAA,iBAARA,SAAA,CAAUE,KAAK,CAAC,CAAC,CAAC,CAAC,GAAI,KAAK,EAAM,CAAC,cAC1CnO,IAAA,QAAAsN,QAAA,cACEpN,KAAA,CAACsD,YAAY,EAAA8J,QAAA,eACXtN,IAAA,CAAC0D,cAAc,EAAA4J,QAAA,CACZY,YAAY,CAACxF,OAAO,CACP,CAAC,cACjBxI,KAAA,QAAAoN,QAAA,eACEtN,IAAA,QAAKwN,KAAK,CAAE,CAAEY,UAAU,CAAE,KAAK,CAAEC,QAAQ,CAAE,MAAO,CAAE,CAAAf,QAAA,CACjDY,YAAY,CAACjH,IAAI,CACf,CAAC,cACNjH,IAAA,QAAKwN,KAAK,CAAE,CAAEa,QAAQ,CAAE,MAAM,CAAET,KAAK,CAAE,MAAO,CAAE,CAAAN,QAAA,CAC7CY,YAAY,CAACnH,KAAK,CAChB,CAAC,EACH,CAAC,EACM,CAAC,CACZ,CAAC,cACN7G,KAAA,QAAAoN,QAAA,EAAK,GAAC,CAACzF,KAAK,CAAC4B,MAAM,EAAI5B,KAAK,CAAC2B,WAAW,EAAI,MAAM,EAAM,CAAC,cACzDxJ,IAAA,QAAAsN,QAAA,cACEtN,IAAA,CAACkB,WAAW,EAACoN,SAAS,CAAEzG,KAAK,CAACmB,MAAO,CAAAsE,QAAA,CAClCzF,KAAK,CAACmB,MAAM,CACF,CAAC,CACX,CAAC,cACNhJ,IAAA,QAAAsN,QAAA,cACEtN,IAAA,CAACkB,WAAW,EAACoN,SAAS,CAAEzG,KAAK,CAAC0G,aAAc,CAAAjB,QAAA,CACzCzF,KAAK,CAAC0G,aAAa,CACT,CAAC,CACX,CAAC,cACNrO,KAAA,QAAAoN,QAAA,eACEtN,IAAA,CAACyB,YAAY,EACX6M,SAAS,CAAC,SAAS,CACnBf,OAAO,CAAEA,CAAA,GAAMvI,QAAQ,UAAU,CAAE,CAAAsI,QAAA,CACpC,MAED,CAAc,CAAC,CAEdzF,KAAK,CAACmB,MAAM,GAAK,WAAW,eAC3BhJ,IAAA,CAACyB,YAAY,EACX6M,SAAS,CAAC,SAAS,CACnBf,OAAO,CAAEA,CAAA,GAAMtB,iBAAiB,CAACpE,KAAK,CAAE,CAAAyF,QAAA,CACzC,MAED,CAAc,CACf,CAEAzF,KAAK,CAACmB,MAAM,GAAK,SAAS,eACzBhJ,IAAA,CAACyB,YAAY,EACX6M,SAAS,CAAC,SAAS,CACnBf,OAAO,CAAEA,CAAA,GAAMlC,iBAAiB,CAACxD,KAAK,CAACrB,EAAE,CAAE,WAAW,CAAEqB,KAAK,CAAE,CAAAyF,QAAA,CAChE,SAED,CAAc,CACf,CAEAzF,KAAK,CAACmB,MAAM,GAAK,WAAW,EAAInB,KAAK,CAACmB,MAAM,GAAK,WAAW,eAC3DhJ,IAAA,CAACyB,YAAY,EACX6M,SAAS,CAAC,QAAQ,CAClBf,OAAO,CAAEA,CAAA,GAAMT,WAAW,CAACjF,KAAK,CAACrB,EAAE,CAAEqB,KAAK,CAAE,CAAAyF,QAAA,CAC7C,QAED,CAAc,CACf,cAEDtN,IAAA,CAACyB,YAAY,EACX6M,SAAS,CAAC,QAAQ,CAClBf,OAAO,CAAEA,CAAA,GAAMxB,eAAe,CAAClE,KAAK,CAAE,CAAAyF,QAAA,CACvC,QAED,CAAc,CAAC,EACZ,CAAC,GArEOzF,KAAK,CAACrB,EAsEX,CAAC,CAEf,CAAC,CAAC,EACS,CACd,CAGArC,WAAW,eACVnE,IAAA,CAAC2B,KAAK,EAAA2L,QAAA,cACJpN,KAAA,CAAC2B,YAAY,EAAAyL,QAAA,eACXtN,IAAA,OAAAsN,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/BtN,IAAA,MAAAsN,QAAA,CAAG,6CAA2C,CAAG,CAAC,cAClDpN,KAAA,MAAAoN,QAAA,eAAGtN,IAAA,WAAAsN,QAAA,CAAQ,WAAS,CAAQ,CAAC,KAAE,CAAC,EAAAzJ,eAAA,CAAAM,WAAW,CAACqC,EAAE,UAAA3C,eAAA,iBAAdA,eAAA,CAAgBsK,KAAK,CAAC,CAAC,CAAC,CAAC,GAAI,KAAK,EAAI,CAAC,cACvEjO,KAAA,MAAAoN,QAAA,eAAGtN,IAAA,WAAAsN,QAAA,CAAQ,SAAO,CAAQ,CAAC,KAAE,CAACnJ,WAAW,CAACsF,MAAM,EAAItF,WAAW,CAACqF,WAAW,EAAI,CAAC,cAChFtJ,KAAA,MAAAoN,QAAA,eAAGtN,IAAA,WAAAsN,QAAA,CAAQ,SAAO,CAAQ,CAAC,IAAC,CAACnJ,WAAW,CAAC6E,MAAM,EAAI,CAAC,cACpDhJ,IAAA,MAAGwN,KAAK,CAAE,CAAEI,KAAK,CAAE,SAAS,CAAEQ,UAAU,CAAE,KAAM,CAAE,CAAAd,QAAA,CAAC,4CAEnD,CAAG,CAAC,cACJpN,KAAA,CAAC6B,YAAY,EAAAuL,QAAA,eACXtN,IAAA,CAACiC,aAAa,EAACsL,OAAO,CAAEA,CAAA,GAAM1B,WAAW,CAAC1H,WAAW,CAACqC,EAAE,CAAE,CAAA8G,QAAA,CAAC,cAE3D,CAAe,CAAC,cAChBtN,IAAA,CAACmC,YAAY,EAACoL,OAAO,CAAEvB,gBAAiB,CAAAsB,QAAA,CAAC,QAEzC,CAAc,CAAC,EACH,CAAC,EACH,CAAC,CACV,CACR,CAGAjJ,aAAa,eACZrE,IAAA,CAACyC,aAAa,EAAA6K,QAAA,cACZpN,KAAA,CAACyC,oBAAoB,EAAA2K,QAAA,eACnBtN,IAAA,OAAAsN,QAAA,CAAI,yBAAa,CAAI,CAAC,cACtBpN,KAAA,MAAAoN,QAAA,EAAG,kBAAgB,CAAC,EAAAxJ,iBAAA,CAAAO,aAAa,CAACmC,EAAE,UAAA1C,iBAAA,iBAAhBA,iBAAA,CAAkBqK,KAAK,CAAC,CAAC,CAAC,CAAC,GAAI,KAAK,EAAI,CAAC,CAE5D,CAAC,IAAM,CACN,KAAM,CAAAD,YAAY,CAAG5F,sBAAsB,CAACjE,aAAa,CAAC,CAC1D,mBACEnE,KAAA,MAAAoN,QAAA,eACEtN,IAAA,WAAAsN,QAAA,CAAQ,WAAS,CAAQ,CAAC,IAAC,CAACY,YAAY,CAACjH,IAAI,CAAC,IAAE,CAACiH,YAAY,CAACnH,KAAK,CAAC,GACtE,EAAG,CAAC,CAER,CAAC,EAAE,CAAC,cAEJ7G,KAAA,CAAC2C,SAAS,EAAAyK,QAAA,eACRtN,IAAA,CAAC+C,KAAK,EAAAuK,QAAA,CAAC,mBAAiB,CAAO,CAAC,cAChCtN,IAAA,CAACkD,KAAK,EACJsL,IAAI,CAAC,MAAM,CACX9B,KAAK,CAAE/H,YAAY,CAACE,cAAe,CACnC4J,QAAQ,CAAGC,CAAC,EAAKlC,wBAAwB,CAAC,gBAAgB,CAAEkC,CAAC,CAACC,MAAM,CAACjC,KAAK,CAAE,CAC5EkC,WAAW,CAAC,uBAAuB,CACnCC,QAAQ,MACT,CAAC,EACO,CAAC,cAEZ3O,KAAA,CAAC2C,SAAS,EAAAyK,QAAA,eACRtN,IAAA,CAAC+C,KAAK,EAAAuK,QAAA,CAAC,WAAS,CAAO,CAAC,cACxBpN,KAAA,CAACmD,MAAM,EACLqJ,KAAK,CAAE/H,YAAY,CAACG,OAAQ,CAC5B2J,QAAQ,CAAGC,CAAC,EAAKlC,wBAAwB,CAAC,SAAS,CAAEkC,CAAC,CAACC,MAAM,CAACjC,KAAK,CAAE,CACrEmC,QAAQ,MAAAvB,QAAA,eAERtN,IAAA,WAAQ0M,KAAK,CAAC,qBAAqB,CAAAY,QAAA,CAAC,qBAAmB,CAAQ,CAAC,cAChEtN,IAAA,WAAQ0M,KAAK,CAAC,OAAO,CAAAY,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpCtN,IAAA,WAAQ0M,KAAK,CAAC,KAAK,CAAAY,QAAA,CAAC,KAAG,CAAQ,CAAC,cAChCtN,IAAA,WAAQ0M,KAAK,CAAC,MAAM,CAAAY,QAAA,CAAC,MAAI,CAAQ,CAAC,cAClCtN,IAAA,WAAQ0M,KAAK,CAAC,KAAK,CAAAY,QAAA,CAAC,KAAG,CAAQ,CAAC,EAC1B,CAAC,EACA,CAAC,cAEZpN,KAAA,CAAC2C,SAAS,EAAAyK,QAAA,eACRtN,IAAA,CAAC+C,KAAK,EAAAuK,QAAA,CAAC,sBAAoB,CAAO,CAAC,cACnCtN,IAAA,CAACkD,KAAK,EACJsL,IAAI,CAAC,MAAM,CACX9B,KAAK,CAAE/H,YAAY,CAACI,iBAAkB,CACtC0J,QAAQ,CAAGC,CAAC,EAAKlC,wBAAwB,CAAC,mBAAmB,CAAEkC,CAAC,CAACC,MAAM,CAACjC,KAAK,CAAE,CAC/EmC,QAAQ,MACT,CAAC,EACO,CAAC,cAEZ3O,KAAA,QAAKsN,KAAK,CAAE,CACVE,UAAU,CAAE,SAAS,CACrBoB,OAAO,CAAE,MAAM,CACfC,YAAY,CAAE,KAAK,CACnBjB,YAAY,CAAE,MAAM,CACpBkB,UAAU,CAAE,mBACd,CAAE,CAAA1B,QAAA,eACAtN,IAAA,OAAIwN,KAAK,CAAE,CAAEyB,MAAM,CAAE,YAAY,CAAErB,KAAK,CAAE,SAAU,CAAE,CAAAN,QAAA,CAAC,iCAAqB,CAAI,CAAC,cACjFtN,IAAA,MAAGwN,KAAK,CAAE,CAAEyB,MAAM,CAAE,OAAO,CAAEZ,QAAQ,CAAE,MAAM,CAAET,KAAK,CAAE,SAAU,CAAE,CAAAN,QAAA,CAAC,uFAEnE,CAAG,CAAC,EACD,CAAC,cAENpN,KAAA,CAAC6B,YAAY,EAAAuL,QAAA,eACXtN,IAAA,CAACiC,aAAa,EACZsL,OAAO,CAAEV,eAAgB,CACzBW,KAAK,CAAE,CAAEE,UAAU,CAAE,SAAU,CAAE,CACjCwB,QAAQ,CAAE,CAACvK,YAAY,CAACE,cAAc,EAAI,CAACF,YAAY,CAACG,OAAO,EAAI,CAACH,YAAY,CAACI,iBAAkB,CAAAuI,QAAA,CACpG,+BAED,CAAe,CAAC,cAChBtN,IAAA,CAACmC,YAAY,EAACoL,OAAO,CAAEhB,kBAAmB,CAAAe,QAAA,CAAC,QAE3C,CAAc,CAAC,EACH,CAAC,EACK,CAAC,CACV,CAChB,EACQ,CAAC,CAEhB,CAAC,CAED,cAAe,CAAA1J,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}